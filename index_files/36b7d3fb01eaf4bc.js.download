(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,248097,(e,t,a)=>{e.e,function(e,t){"use strict";var a=function(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(a){if("default"!==a){var r=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,r.get?r:{enumerable:!0,get:function(){return e[a]}})}}),t.default=e,Object.freeze(t)}(t);function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o={error:null},s=function(e){function t(){for(var t,a=arguments.length,r=Array(a),s=0;s<a;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))||this).state=o,t.resetErrorBoundary=function(){for(var e,a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];null==t.props.onReset||(e=t.props).onReset.apply(e,r),t.reset()},t}t.prototype=Object.create(e.prototype),t.prototype.constructor=t,r(t,e),t.getDerivedStateFromError=function(e){return{error:e}};var s=t.prototype;return s.reset=function(){this.setState(o)},s.componentDidCatch=function(e,t){var a,r;null==(a=(r=this.props).onError)||a.call(r,e,t)},s.componentDidUpdate=function(e,t){var a,r,o,s,n=this.state.error,i=this.props.resetKeys;null!==n&&null!==t.error&&(void 0===(a=e.resetKeys)&&(a=[]),void 0===(r=i)&&(r=[]),a.length!==r.length||a.some(function(e,t){return!Object.is(e,r[t])}))&&(null==(o=(s=this.props).onResetKeysChange)||o.call(s,e.resetKeys,i),this.reset())},s.render=function(){var e=this.state.error,t=this.props,r=t.fallbackRender,o=t.FallbackComponent,s=t.fallback;if(null!==e){var n={error:e,resetErrorBoundary:this.resetErrorBoundary};if(a.isValidElement(s))return s;if("function"==typeof r)return r(n);if(o)return a.createElement(o,n);else throw Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},t}(a.Component);e.ErrorBoundary=s,e.useErrorHandler=function(e){var t=a.useState(null),r=t[0],o=t[1];if(null!=e)throw e;if(null!=r)throw r;return o},e.withErrorBoundary=function(e,t){var r=function(r){return a.createElement(s,t,a.createElement(e,r))};return r.displayName="withErrorBoundary("+(e.displayName||e.name||"Unknown")+")",r},Object.defineProperty(e,"__esModule",{value:!0})}(a,e.r(271645))},692969,658856,255783,e=>{"use strict";var t,a=e.i(843476);e.i(262202);var r=e.i(111914),o=e.i(730589),s=e.i(867426),n=e.i(875744),i=e.i(271645),l=e.i(450608),d=e.i(558639),u=e.i(947414),c=e.i(485900),m=e.i(783164);function f(e,t,a){if("string"==typeof e){let r=document;t&&((0,m.invariant)(!!t.current,"Scope provided, but no element detected."),r=t.current),a?(null!=a[e]||(a[e]=r.querySelectorAll(e)),e=a[e]):e=r.querySelectorAll(e)}else e instanceof Element&&(e=[e]);return Array.from(e||[])}var g=e.i(692968);class h{constructor(e){this.animations=e.filter(Boolean)}then(e,t){return Promise.all(this.animations).then(e).catch(t)}getAll(e){return this.animations[0][e]}setAll(e,t){for(let a=0;a<this.animations.length;a++)this.animations[a][e]=t}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}play(){this.runAll("play")}pause(){this.runAll("pause")}stop(){this.runAll("stop")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}var p=e.i(306327),x=e.i(92180),v=e.i(678310),y=e.i(457044),b=e.i(959652),k=e.i(166481),S=e.i(519871),w=e.i(285),C=e.i(630040),T=e.i(895119),E=e.i(738700),j=e.i(298549);function N(e,t,a,r){var o;return"number"==typeof t?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,e+parseFloat(t)):"<"===t?a:null!=(o=r.get(t))?o:e}var _=e.i(241790),I=e.i(803668),B=e.i(362756);function O(e,t){return e.at!==t.at?e.at-t.at:null===e.value?1:null===t.value?-1:0}function L(e,t){return t.has(e)||t.set(e,{}),t.get(e)}function D(e,t){return t[e]||(t[e]=[]),t[e]}let R=e=>"number"==typeof e,M=e=>e.every(R);function P(e,t,a,r){let o=f(e,r),s=o.length;(0,m.invariant)(!!s,"No valid element provided.");let n=[];for(let e=0;e<s;e++){let r=o[e];g.visualElementStore.has(r)||function(e){let t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},a=(0,x.isSVGElement)(e)?new v.SVGVisualElement(t,{enableHardwareAcceleration:!1}):new y.HTMLVisualElement(t,{enableHardwareAcceleration:!0});a.mount(e),g.visualElementStore.set(e,a)}(r);let i=g.visualElementStore.get(r),l={...a};"function"==typeof l.delay&&(l.delay=l.delay(e,s)),n.push(...(0,p.animateTarget)(i,{...t,transition:l},{}))}return new h(n)}let A=e=>function(t,a,r){let o;if(Array.isArray(t)&&Array.isArray(t[0])){let r;r=[],(function(e,{defaultTransition:t={},...a}={},r){let o=t.duration||.3,s=new Map,n=new Map,i={},l=new Map,d=0,u=0,c=0;for(let a=0;a<e.length;a++){let s=e[a];if("string"==typeof s){l.set(s,u);continue}if(!Array.isArray(s)){l.set(s.name,N(u,s.at,d,l));continue}let[h,p,x={}]=s;void 0!==x.at&&(u=N(u,x.at,d,l));let v=0,y=(e,a,r,s=0,n=0)=>{var i;let l=Array.isArray(i=e)?i:[i],{delay:d=0,times:m=(0,C.defaultOffset)(l),type:f="keyframes",...g}=a,{ease:h=t.ease||"easeOut",duration:p}=a,x="function"==typeof d?d(s,n):d,y=l.length;if(y<=2&&"spring"===f){let e=100;2===y&&M(l)&&(e=Math.abs(l[1]-l[0]));let t={...g};void 0!==p&&(t.duration=(0,w.secondsToMilliseconds)(p));let a=function(e,t=100){let a=(0,k.spring)({keyframes:[0,t],...e}),r=Math.min((0,S.calcGeneratorDuration)(a),S.maxGeneratorDuration);return{type:"keyframes",ease:e=>a.next(r*e).value/t,duration:(0,w.millisecondsToSeconds)(r)}}(t,e);h=a.ease,p=a.duration}null!=p||(p=o);let b=u+x,E=b+p;1===m.length&&0===m[0]&&(m[1]=1);let j=m.length-l.length;j>0&&(0,T.fillOffset)(m,j),1===l.length&&l.unshift(null),function(e,t,a,r,o,s){for(let t=0;t<e.length;t++){let a=e[t];a.at>o&&a.at<s&&((0,I.removeItem)(e,a),t--)}for(let n=0;n<t.length;n++)e.push({value:t[n],at:(0,B.mix)(o,s,r[n]),easing:function(e,t){var a;let r;return(0,_.isEasingArray)(e)?e[a=e.length,((t-0)%(r=a-0)+r)%r+0]:e}(a,n)})}(r,l,h,m,b,E),v=Math.max(x+p,v),c=Math.max(E,c)};if((0,j.isMotionValue)(h))y(p,x,D("default",L(h,n)));else{let e=f(h,r,i),t=e.length;for(let a=0;a<t;a++){let r=L(e[a],n);for(let e in p){var m,g;y(p[e],(m=x)[g=e]?{...m,...m[g]}:{...m},D(e,r),a,t)}}d=u,u+=v}}return n.forEach((e,r)=>{for(let o in e){let n=e[o];n.sort(O);let i=[],l=[],d=[];for(let e=0;e<n.length;e++){let{at:t,value:a,easing:r}=n[e];i.push(a),l.push((0,E.progress)(0,c,t)),d.push(r||"easeOut")}0!==l[0]&&(l.unshift(0),i.unshift(i[0]),d.unshift("easeInOut")),1!==l[l.length-1]&&(l.push(1),i.push(null)),s.has(r)||s.set(r,{keyframes:{},transition:{}});let u=s.get(r);u.keyframes[o]=i,u.transition[o]={...t,duration:c,ease:d,times:l,...a}}}),s})(t,a,e).forEach(({keyframes:e,transition:t},a)=>{let o;o=(0,j.isMotionValue)(a)?(0,b.animateSingleValue)(a,e.default,t.default):P(a,e,t),r.push(o)}),o=new h(r)}else o="object"!=typeof a||Array.isArray(a)?(0,b.animateSingleValue)(t,a,r):P(t,a,r,e);return e&&e.animations.push(o),o};A();var U=e.i(247167),V=e.i(422875),F=e.i(796097),z=e.i(865420);let W={variants:{visible:{opacity:1,x:0},hidden:{opacity:0,x:20}},initial:"hidden",exit:"hidden",animate:"visible",transition:{ease:"easeInOut",delay:.1}},$={variants:{visible:{opacity:1,y:0},hidden:{opacity:0,y:20}},initial:"hidden",exit:"hidden",animate:"visible",transition:{ease:"easeInOut",delay:.1}},Y={mobile:{default:{width:"100%",minHeight:"0px",gridTemplateAreas:`
          "meta"
          "header"
          "main"
          "timeslots"
        `,gridTemplateColumns:"100%",gridTemplateRows:"minmax(min-content,max-content) 1fr"}},month_view:{default:{width:"calc(var(--booker-meta-width) + var(--booker-main-width))",minHeight:"450px",height:"auto",gridTemplateAreas:`
      "meta main main"
      "meta main main"
      `,gridTemplateColumns:"var(--booker-meta-width) var(--booker-main-width)",gridTemplateRows:"1fr 0fr"},selecting_time:{width:"calc(var(--booker-meta-width) + var(--booker-main-width) + var(--booker-timeslots-width))",minHeight:"450px",height:"auto",gridTemplateAreas:`
      "meta main timeslots"
      "meta main timeslots"
      `,gridTemplateColumns:"var(--booker-meta-width) 1fr var(--booker-timeslots-width)",gridTemplateRows:"1fr 0fr"}},week_view:{default:{width:"100vw",minHeight:"100vh",height:"auto",gridTemplateAreas:`
      "meta header header"
      "meta main main"
      `,gridTemplateColumns:"var(--booker-meta-width) 1fr",gridTemplateRows:"70px auto"}},column_view:{default:{width:"100vw",minHeight:"100vh",height:"auto",gridTemplateAreas:`
      "meta header header"
      "meta main main"
      `,gridTemplateColumns:"var(--booker-meta-width) 1fr",gridTemplateRows:"70px auto"}}},H={mobile:{desktop:0,tablet:0},[z.BookerLayouts.MONTH_VIEW]:{desktop:0,tablet:0},[z.BookerLayouts.WEEK_VIEW]:{desktop:7,tablet:4},[z.BookerLayouts.COLUMN_VIEW]:{desktop:6,tablet:2}},Z=e=>z.bookerLayoutOptions.find(t=>t===e);var q=e.i(196268),Q=e.i(313069),K=e.i(994814),G=e.i(653145),J=e.i(50270),X=e.i(118540),ee=e.i(779770),et=e.i(894706),ea=e.i(162234),er=e.i(19109),eo=e.i(69692);let es=()=>J.z.string().refine(e=>e.trim().length>0);J.z.object({label:J.z.string(),value:z.fieldTypeEnum,isTextType:J.z.boolean().default(!1).optional(),systemOnly:J.z.boolean().default(!1).optional(),needsOptions:J.z.boolean().default(!1).optional(),supportsLengthCheck:J.z.object({maxLength:J.z.number()}).optional(),supportsPricing:J.z.boolean().default(!1).optional(),optionsSupportPricing:J.z.boolean().default(!1).optional(),propsType:J.z.enum(["text","textList","select","multiselect","boolean","objectiveWithInput","variants"]),variantsConfig:J.z.object({defaultVariant:J.z.string(),toggleLabel:J.z.string().optional(),variants:J.z.record(J.z.object({label:J.z.string(),fieldsMap:J.z.record(J.z.object({defaultLabel:J.z.string().optional(),defaultPlaceholder:J.z.string().optional(),canChangeRequirability:J.z.boolean().default(!0).optional()}))})),defaultValue:z.variantsConfigSchema.optional()}).optional()}).refine(e=>{if(!e.variantsConfig)return;let t=e.variantsConfig;if(!t.variants[t.defaultVariant])throw Error(`defaultVariant: ${t.defaultVariant} is not in variants`);return!0}),J.z.array(z.fieldSchema);let en={name:{preprocess:({response:e,field:t})=>{let a,r=ea.fieldTypesConfigMap[t.type],o=t.variant||r?.variantsConfig?.defaultVariant;if(!o)throw Error("`variant` must be there for the field with `variantsConfig`");return a="firstAndLastName"!==o&&"fullName"!==o?"fullName":o,(0,er.preprocessNameFieldDataWithVariant)(a,e)},superRefine:({field:e,response:t,isPartialSchema:a,ctx:r,m:o})=>{let s=J.z.string(),n=ea.fieldTypesConfigMap[e.type],i=e.variant||n?.variantsConfig?.defaultVariant;if(!i)throw Error("`variant` must be there for the field with `variantsConfig`");let l=(0,eo.getConfig)(e);if(!l)throw Error("variantsConfig must be there for `name` field");let d=l.variants[i].fields,u=["text"];if(1===d.length){let e=d[0];if(u.includes(e.type)){(e.required&&!a?es():s).safeParse(t).success||r.addIssue({code:J.z.ZodIssueCode.custom,message:o("Invalid string")});return}throw Error(`Unsupported field.type with variants: ${e.type}`)}d.forEach(e=>{let n=e.required&&!a?es():s;if(!u.includes(e.type))throw Error(`Unsupported field.type with variants: ${e.type}`);if(e.required&&(a||t[e.name]||r.addIssue({code:J.z.ZodIssueCode.custom,message:o("error_required_field")}),!n.safeParse(t[e.name]).success))return void r.addIssue({code:J.z.ZodIssueCode.custom,message:o("Invalid string")})})}},textarea:{preprocess:({response:e})=>e.trim(),superRefine:({field:e,response:t,ctx:a,m:r})=>{let o=ea.fieldTypesConfigMap[e.type],s=t??"",n=e.maxLength??o.supportsLengthCheck?.maxLength,i=e.minLength??0;if(!n)throw Error("maxLength must be there for textarea field");let l=s.length>n,d=s.length<i;if(l){let e=r("max_characters_allowed",{count:n});a.addIssue({code:J.z.ZodIssueCode.custom,message:e});return}if(d){let e=r("min_characters_required",{count:i});a.addIssue({code:J.z.ZodIssueCode.custom,message:e});return}}},url:{preprocess:({response:e})=>e.trim(),superRefine:({response:e,ctx:t,m:a})=>{let r=e??"",o=J.z.string().url();if(r.match(/^https?:\/[^\/]/))return void t.addIssue({code:J.z.ZodIssueCode.custom,message:a("url_validation_error")});if(!o.safeParse(r).success){if(/^[a-z0-9.-]+\.[a-z]{2,}(\/.*)?$/i.test(r)){let e=`https://${r}`;if(o.safeParse(e).success)return}t.addIssue({code:J.z.ZodIssueCode.custom,message:a("url_validation_error")})}}}},ei=J.z.union([J.z.string(),J.z.boolean(),J.z.string().array(),J.z.object({optionValue:J.z.string(),value:J.z.string()}),J.z.record(J.z.string())]);var el=e.i(294951);let ed=et.default.record(ei),eu=e=>e?e.replace(/^ +/,"+"):"",ec=(e,t)=>{let a=e.toLowerCase();if(t.startsWith("@")){let e=t.slice(1).toLowerCase();return a.endsWith("@"+e)}return t.includes("@")?a===t.toLowerCase():a.endsWith("@"+t.toLowerCase())};function em({schema:e,bookingFields:t,isPartialSchema:a,view:r,checkOptional:o=!1,translateFn:s}){let n=el.default.getSubLogger({prefix:["getBookingResponsesSchema"]}),i=et.default.preprocess(e=>{let o=et.default.record(et.default.any()).nullable().parse(e)||{},s={};return t?(t.forEach(e=>{let t=o[e.name];if(void 0===t)return;let i=e.views;if(!("ALL_VIEWS"===r||!i||i.find(e=>e.id===r)))return;let l=en[e.type];if(l){s[e.name]=l.preprocess({response:t,isPartialSchema:a,field:e});return}if("boolean"===e.type)s[e.name]="true"===t||!0===t;else if("multiemail"===e.type||"checkbox"===e.type||"multiselect"===e.type)s[e.name]=t instanceof Array?t:[t];else if("radioInput"===e.type&&"string"==typeof t){let a={optionValue:"",value:""};try{a=JSON.parse(t)}catch(t){n.error(`Failed to parse JSON for field ${e.name}`,t)}let r=e.optionsInputs,o=r?.[a.value];o&&"phone"===o.type&&(a.optionValue=eu(a.optionValue)),s[e.name]=a}else"phone"===e.type?s[e.name]=eu(t):s[e.name]=t}),{...o,...s}):o},e.superRefine(async(e,n)=>{if(!t)return;let i=t.find(e=>"attendeePhoneNumber"===e.name),l=i?.hidden,d=t.find(e=>"email"===e.name);for(let i of(d?.hidden&&!l&&(e.email=""),t)){let t=e[i.name],l=et.default.string(),d=a?et.default.string():et.default.string().refine(z.emailSchemaRefinement),u=a?et.default.string():et.default.string().refine(async e=>(0,ee.isValidPhoneNumber)(e)),c=(e,t)=>{let a=s?s(e,t):e;return`{${i.name}}${a}`},m=i.views,f="ALL_VIEWS"===r||!m||m.find(e=>e.id===r),g=i.hidden,h=i.options?.length??0;i.hideWhenJustOneOption&&(g=g||h<=1);let p=!1;if(!g&&f&&(p=o||!!i.required),(a||!p)&&void 0===t)continue;if(p&&!a&&!t)return void n.addIssue({code:et.default.ZodIssueCode.custom,message:c("error_required_field")});if("email"===i.type){if(!i.hidden&&(p||t&&""!==t.trim())&&(d.safeParse(t).success||n.addIssue({code:et.default.ZodIssueCode.custom,message:c("email_validation_error")}),t)){(i.excludeEmails?.split(",").map(e=>e.trim())||[]).find(e=>ec(t,e))&&n.addIssue({code:et.default.ZodIssueCode.custom,message:c("exclude_emails_match_found_error_message")});let e=i.requireEmails?.split(",").map(e=>e.trim()).filter(Boolean)||[],a=e.find(e=>ec(t,e));e.length>0&&!a&&n.addIssue({code:et.default.ZodIssueCode.custom,message:c("require_emails_no_match_found_error_message")})}continue}let x=en[i.type];if(x){x.superRefine({response:t,ctx:n,m:c,field:i,isPartialSchema:a});continue}if("multiemail"===i.type){let a=d.array().safeParse(t);if(p&&(!t||0===t.length)){n.addIssue({code:et.default.ZodIssueCode.custom,message:c("error_required_field")});continue}if(!a.success){if("guests"===i.name&&t.every(e=>""===e)){e[i.name]=[];continue}n.addIssue({code:et.default.ZodIssueCode.custom,message:c("email_validation_error")});continue}let r=a.data;r.sort().some((e,t)=>{if(e===r[t+1])return n.addIssue({code:et.default.ZodIssueCode.custom,message:c("duplicate_email")}),!0});continue}if("multiselect"===i.type){if(p&&(!t||0===t.length)){n.addIssue({code:et.default.ZodIssueCode.custom,message:c("error_required_field")});continue}l.array().safeParse(t).success||n.addIssue({code:et.default.ZodIssueCode.custom,message:c("Invalid array of strings")});continue}if("checkbox"===i.type){l.array().safeParse(t).success||n.addIssue({code:et.default.ZodIssueCode.custom,message:c("Invalid array of strings")});continue}if("phone"===i.type){let e=p||t&&""!==t.trim();i.hidden||!e||(await u.safeParseAsync(t)).success||n.addIssue({code:et.default.ZodIssueCode.custom,message:c("invalid_number")});continue}if("boolean"===i.type){et.default.boolean().safeParse(t).success||n.addIssue({code:et.default.ZodIssueCode.custom,message:c("Invalid Boolean")});continue}if("radioInput"===i.type){if(i.optionsInputs){let e=t?.optionValue,a=i.optionsInputs[t?.value],r=a?.type;if((p||t?.value)&&o||a?.required&&!e)return void n.addIssue({code:et.default.ZodIssueCode.custom,message:c("error_required_field")});e&&"phone"===r&&!(await u.safeParseAsync(e)).success&&n.addIssue({code:et.default.ZodIssueCode.custom,message:c("invalid_number")})}continue}if(["address","text","select","number","radio","textarea"].includes(i.type)){l.safeParse(t).success||n.addIssue({code:et.default.ZodIssueCode.custom,message:c("Invalid string")});continue}n.addIssue({code:et.default.ZodIssueCode.custom,message:`Can't parse unknown booking field type: ${i.type}`})}}));return a?i.catch(function(e){return console.error("Failed to preprocess query params, prefilling will be skipped",e?.error),{}}):i}var ef=e.i(12346);let eg=({values:e,hasSession:t,stableHashExtraOptions:a})=>`${Object.keys(e).length}_${+!!t}_${e.bookingId??0}_${a}`;var eh=e.i(954616),ep=e.i(618566);e.i(290339);var ex=e.i(657732),ev=e.i(363828),ey=e.i(574068),eb=e.i(422233),ek=e.i(623101),eS=e.i(279585),ew=e.i(411016);e.i(138180);var eC=e.i(656860),eT=e.i(759023);let eE=/^(.*)([+-])(\d{2}):(\d{2})|(Z)$/,ej=({startDate:e,timeZone:t,recurringEvent:a,recurringCount:r,selectedTimeFormat:o,withDefaultTimeFormat:s},n)=>{let{count:i,...l}=a||{},d=new eC.RRule({...l,count:r,dtstart:new Date((0,ek.default)(e).valueOf())}),u=(0,ek.default)(e).utcOffset(),c=d.all().map(e=>ek.default.utc(e).add(u-(0,ek.default)(e).utcOffset(),"minute"));return[c.map(e=>((e,t,a,r)=>{let o=function(e,t,a,r){if("string"!=typeof e)return(0,ek.default)(e,void 0,void 0,void 0);let o=e.match(eE);if(null===o)return;if("Z"===o[0])return(0,ek.default)(e,{utc:!0,...void 0},void 0,void 0);let[,s,n,i,l]=o,d=60*parseInt(i)+parseInt(l,10);return(0,ek.default)(s,{$offset:"+"===n?d:-d,...void 0},void 0,void 0)}(e);if(!o?.isValid())return"Invalid date";let s=o?.format(r?.withDefaultTimeFormat?eT.TimeFormat.TWELVE_HOUR:r?.selectedTimeFormat||eT.detectBrowserTimeFormat);return`${s}, ${(0,ek.default)(e).toDate().toLocaleString(t,{dateStyle:"full",timeZone:a})}`})(e.tz(t),n,t,{selectedTimeFormat:o,withDefaultTimeFormat:s})),c.map(e=>e.toDate())]},eN=({values:e,event:t,date:a,duration:r,timeZone:o,language:s,rescheduleUid:n,rescheduledBy:i,username:l,metadata:d,bookingUid:u,seatReferenceUid:c,hashedLink:m,teamMemberEmail:f,crmOwnerRecordType:g,crmAppSlug:h,crmRecordId:p,orgSlug:x,routingFormSearchParams:v,isDryRunProp:y,verificationCode:b,rrHostSubsetIds:k})=>{let S=new URLSearchParams(v??window.location.search),w=(0,ew.getRoutedTeamMemberIdsFromSearchParams)(S),C=S.get("cal.routingFormResponseId"),T=C?Number(C):void 0,E="true"===S.get("cal.skipContactOwner"),j=S.get("cal.reroutingFormResponses"),N=void 0!==y?y:(0,eS.isBookingDryRun)(S),_=S?.get("dub_id");return{...e,user:l,start:(0,ek.default)(a).format(),end:(0,ek.default)(a).add(r||t.length,"minute").format(),eventTypeId:t.id,eventTypeSlug:t.slug,timeZone:o,language:s,rescheduleUid:n,rescheduledBy:i,metadata:d||{},hasHashedBookingLink:!!m,bookingUid:u,seatReferenceUid:c,hashedLink:m,teamMemberEmail:f,crmOwnerRecordType:g,crmAppSlug:h,crmRecordId:p,orgSlug:x,routedTeamMemberIds:w,rrHostSubsetIds:k,routingFormResponseId:T,skipContactOwner:E,reroutingFormResponses:j?JSON.parse(j):void 0,_isDryRun:N,dub_id:_,verificationCode:b}};var e_=e.i(647842),eI=e.i(788442),eB=e.i(264310),eO=e.i(935746);let eL=async e=>await (0,eO.post)("/api/book/instant-event",e),eD=async e=>await (0,eO.post)("/api/book/recurring-event",e);var eR=e.i(23480),eM=e.i(207597),eP=e.i(331597),eA=e.i(273446),eU=e.i(141546);let eV=e=>({title:e.title,startTime:e.startTime,endTime:e.endTime,eventTypeId:e.eventTypeId,status:e.status,paymentRequired:e.paymentRequired,isRecurring:e.isRecurring,videoCallUrl:e.videoCallUrl}),eF=e=>({uid:e.uid,...eV(e)}),ez="instantBookingData",eW="instantBookingCooldownByEvent",e$=()=>{try{let e=eM.localStorage.getItem(eW);return e?JSON.parse(e):{}}catch{return{}}},eY=e=>{if(!e)return 0;let t=e$()[String(e)];if(!t)return 0;let a=t+6e5-Date.now();return a>0?a:0};var eH=e.i(254125),eZ=e.i(227739);let eq=null;var eQ=e.i(24509),eK=e.i(347637);let eG=()=>{let e=(0,i.useRef)((({percentage:e})=>{if(void 0!==U.default&&U.default.env?.NEXT_PUBLIC_IS_E2E||e>=100)return!0;let t="u"<typeof document?null:document.cookie.split(";").find(e=>e.trim().startsWith("uid="))?.split("=")[1];return!!t&&parseInt(t.slice(-4),16)%100<e})({percentage:eQ.PUBLIC_QUICK_AVAILABILITY_ROLLOUT}));return(0,i.useEffect)(()=>{console.log("QuickAvailabilityCheck feature enabled:",e.current)},[]),e.current};var eJ=e.i(217255),eX=e.i(290921),e0=e.i(234452),e1=e.i(923842),e2=e.i(272177),e4=e.i(327255),e3=e.i(401534),e6=e.i(321768),e5=e.i(363020);let e8=()=>{let e=(0,e5.useAtomsContext)();return!!(e?.clientId&&e?.isEmbed)};var e7=e.i(436864),e9=e.i(859653);let te=e.i(962607).domAnimation,tt=e=>!(e.length<16)&&"-"===e[4]&&"-"===e[7]&&"T"===e[10]&&":"===e[13];function ta(e,t){return!!e&&e.some(e=>(({slotTimeInIso:e,slotToCheckInIso:t})=>e===t||(tt(e)&&tt(t)?e.slice(0,16)===t.slice(0,16):(console.log("Invalid ISO string format detected",{slotTimeInIso:e,slotToCheckInIso:t}),!0)))({slotTimeInIso:e.time,slotToCheckInIso:t}))}var tr=e.i(622030),to=e.i(348874);let ts=(e,t)=>{requestAnimationFrame(()=>{1===e?t():requestAnimationFrame(()=>ts(e-1,t))})};var tn=e.i(139033),ti=e.i(676468),tl=e.i(695178),td=e.i(522016);let tu=({logoOnly:e,hasValidLicense:t})=>{let{t:r}=(0,ef.useLocale)(),s=(0,o.useIsEmbed)();return(0,a.jsx)("div",{className:`p-2 text-center text-xs sm:text-right${s?" max-w-3xl":""}`,children:(0,a.jsxs)(td.default,{href:eQ.POWERED_BY_URL,target:"_blank",className:"text-subtle",children:[!e&&(0,a.jsxs)(a.Fragment,{children:[r("powered_by")," "]}),"Cal.com"!==eQ.APP_NAME&&t?(0,a.jsx)("span",{className:"text-emphasis font-semibold opacity-50 hover:opacity-100",children:eQ.APP_NAME}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("img",{className:"-mt-px inline h-[10px] w-auto dark:invert",src:"https://app.cal.com/api/logo",alt:"Cal.com Logo"})})]})})};var tc=e.i(88653),tm=e.i(444113),tf=e.i(309453),tg=e=>!e.firstChild||e.firstChild.offsetParent===e,th=null;"u">typeof CSS&&CSS.supports&&(CSS.supports("position","sticky")?th="sticky":CSS.supports("position","-webkit-sticky")&&(th="-webkit-sticky"));var tp=!1;try{let e=Object.defineProperty({},"passive",{get(){tp={passive:!0}}}),t=()=>{};window.addEventListener("testPassive",t,e),window.removeEventListener("testPassive",t,e)}catch(e){}var tx=e=>{let{el:t,onChange:a,unsubs:r,measure:o}=e;if(t===window){let e=()=>({top:0,left:0,height:window.innerHeight,width:window.innerWidth}),t=o(e()),s=()=>{Object.assign(t,o(e())),a()};return window.addEventListener("resize",s,tp),r.push(()=>window.removeEventListener("resize",s)),t}{let e=o(t.getBoundingClientRect()),s=new ResizeObserver(()=>{Object.assign(e,o(t.getBoundingClientRect())),a()});return s.observe(t),r.push(()=>s.disconnect()),e}},tv=e=>{let{offsetTop:t,offsetBottom:r,bottom:o,children:s,className:n,style:l}=e,d=(({offsetTop:e=0,offsetBottom:t=0,bottom:a=!1}={})=>{let[r,o]=(0,i.useState)(null);return(0,i.useEffect)(()=>{if(!r||!th)return;let o=[];return((e,t,a)=>{let r,{bottom:o,offsetBottom:s,offsetTop:n}=a,i=(e=>{let t=e;for(;t=t.parentElement;){let e=getComputedStyle(t,null).getPropertyValue("overflow-y");if(t===document.body)break;if("auto"===e||"scroll"===e||"overlay"===e)return t}return window})(e),l=!1,d=()=>{l||requestAnimationFrame(()=>{let e=m();e!==b&&k(e),l=!1}),l=!0},u=i===window?window.scrollY:i.scrollTop,c=e=>{let{offsetTop:t,height:a}=g,{naturalTop:r}=x,{height:o}=v;return e+t+a>=r+o+y+s},m=()=>{let{height:e}=g,{height:t}=v;return t+n+s<=e?3:c(u)?1:2},f=i!==window&&tg(i),g=tx({el:i,onChange:d,unsubs:t,measure:({height:e,top:t})=>({height:e,offsetTop:f?t:0})}),h=(e=>{let t=e.parentElement;for(;t&&"contents"===getComputedStyle(t,null).getPropertyValue("display");)t=t.parentElement;return t||window})(e),p=h===window?{top:0,bottom:0}:{top:parseInt((r=getComputedStyle(h,null)).getPropertyValue("padding-top"),10),bottom:parseInt(r.getPropertyValue("padding-bottom"),10)},x=tx({el:h,onChange:d,unsubs:t,measure:({height:e})=>({height:e-p.top-p.bottom,naturalTop:h===window?0:((e,t)=>{let a=e,r=0;tg(t)||(r+=e.offsetTop-t.offsetTop,t=e.offsetParent,r+=-e.offsetTop);do r+=a.offsetTop,a=a.offsetParent;while(a&&a!==t)return r})(h,i)+p.top+g.offsetTop})}),v=tx({el:e,onChange:d,unsubs:t,measure:({height:e})=>({height:e})}),y=0,b=m(),k=t=>{let a=b;if(b=t,2===a&&(y=-1),3===t){e.style.position=th,o?e.style.bottom=`${s}px`:e.style.top=`${n}px`;return}let{height:r,offsetTop:i}=g,{height:l,naturalTop:d}=x,{height:c}=v;if(2===t)if(e.style.position="relative",y=0===a?Math.max(0,i+u-d+n):Math.max(0,i+u+r-(d+c+s)),o){let t=Math.max(0,l-c-y);e.style.bottom=`${t}px`}else e.style.top=`${y}px`;else e.style.position=th,1===t?o?e.style.bottom=`${s}px`:e.style.top=`${r-c-s}px`:o?e.style.bottom=`${r-c-s}px`:e.style.top=`${n}px`};k(b);let S=e=>{if(e===u)return;let t=e-u;if(u=e,3===b)return;let{offsetTop:a,height:r}=g,{naturalTop:o,height:i}=x,{height:l}=v;if(t>0)if(0===b){if(e+a+n>o){let t=Math.max(0,a+u-o+n);e+a+r<=o+l+t+s?k(2):k(1)}}else 2===b&&c(e)&&k(1);else if(1===b){if(a+e+r<o+i+s){let t=Math.max(0,a+u+r-(o+l+s));a+e+n>=o+t?k(2):k(0)}}else 2===b&&a+e+n<o+y&&k(0)},w=i===window?()=>S(window.scrollY):()=>S(i.scrollTop);i.addEventListener("scroll",w,tp),i.addEventListener("mousewheel",w,tp),t.push(()=>i.removeEventListener("scroll",w),()=>i.removeEventListener("mousewheel",w))})(r,o,{offsetBottom:t,offsetTop:e,bottom:a}),()=>{o.forEach(e=>e())}},[r,t,e,a]),o})({offsetTop:t,offsetBottom:r,bottom:o});return(0,a.jsx)("div",{className:n,style:l,ref:d,children:s})},ty=e.i(846696),tb=e.i(140519),tk=e.i(440652),tS=e.i(190203);let tw=({extraDays:e,limitHeight:t,showAvailableSeatsCount:r,schedule:o,isLoading:s,customClassNames:l,skipConfirmStep:d,seatsPerTimeSlot:u,onSubmit:c,unavailableTimeSlots:m,confirmButtonDisabled:f,confirmStepClassNames:g,onAvailableTimeSlotSelect:h,hideAvailableTimesHeader:p=!1,...x})=>{let v=(0,n.useBookerStoreContext)(e=>e.selectedDate),y=(0,n.useBookerStoreContext)(e=>e.setSeatedEventData),b=v||(0,ek.default)().format("YYYY-MM-DD"),[k]=(0,n.useBookerStoreContext)(e=>[e.layout]),S=k===z.BookerLayouts.COLUMN_VIEW,w=(0,i.useRef)(null),{setTentativeSelectedTimeslots:C,tentativeSelectedTimeslots:T}=(0,n.useBookerStoreContext)(e=>({setTentativeSelectedTimeslots:e.setTentativeSelectedTimeslots,tentativeSelectedTimeslots:e.tentativeSelectedTimeslots})),E=({time:e,attendees:t,seatsPerTimeSlot:a,bookingUid:r})=>{C([e])},j=o?.data,N=(0,to.useNonEmptyScheduleDays)(j?.slots).filter(e=>0>=(0,ek.default)(v).diff(e,"day")),_=(0,i.useMemo)(()=>e?N.length>0?N.slice(0,e):[]:[b],[b,e,N]),{slotsPerDay:I,toggleConfirmButton:B}=(0,tk.useSlotsForAvailableDates)(_,j?.slots),O="true"===(0,q.getQueryParam)("overlayCalendar")||eM.localStorage.getItem("overlayCalendarSwitchDefault"),L=(0,i.useCallback)((e,t,a,s)=>{eQ.PUBLIC_INVALIDATE_AVAILABLE_SLOTS_ON_BOOKING_FORM&&o?.invalidate(),C([]),a&&y({seatsPerTimeSlot:a,attendees:t,bookingUid:s,showAvailableSeatsCount:r}),h(e);let n=!m.includes(e);d&&n&&c(e)},[c,y,d,r,m,o,C,h]),D=(0,i.useCallback)((e,t)=>{O&&t||d?B(e):L(e.time,e?.attendees||0,u,e.bookingUid)},[O,L,u,d,B]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:(0,tn.default)("flex",p&&"hidden",`${l?.availableTimeSlotsContainer}`),children:s?(0,a.jsx)("div",{className:"mb-3 h-8"}):I.length>0&&I.map(e=>{let t=e.slots.length>0&&e.slots[0]?.away;return(0,a.jsx)(tS.AvailableTimesHeader,{customClassNames:{availableTimeSlotsHeaderContainer:l?.availableTimeSlotsHeaderContainer,availableTimeSlotsTitle:l?.availableTimeSlotsTitle,availableTimeSlotsTimeFormatToggle:l?.availableTimeSlotsTimeFormatToggle},date:(0,ek.default)(e.date),showTimeFormatToggle:!S&&!t,availableMonth:(0,ek.default)(v).format("MM")!==(0,ek.default)(e.date).format("MM")?(0,ek.default)(e.date).format("MMM"):void 0},e.date)})}),(0,a.jsxs)("div",{ref:w,className:(0,tn.default)(t&&"no-scrollbar grow overflow-auto md:h-[400px]",!t&&"flex h-full w-full flex-row gap-4",`${l?.availableTimeSlotsContainer}`),children:[s&&Array.from({length:1+(e??0)}).map((e,t)=>(0,a.jsx)(tb.AvailableTimesSkeleton,{},t)),!s&&I.length>0&&I.map(e=>(0,a.jsx)("div",{className:"no-scrollbar overflow-x-hidden! h-full w-full overflow-y-auto",children:(0,a.jsx)(tb.AvailableTimes,{className:l?.availableTimeSlotsContainer,customClassNames:l?.availableTimes,showTimeFormatToggle:!S,onTimeSelect:L,onTentativeTimeSelect:E,unavailableTimeSlots:m,slots:e.slots,showAvailableSeatsCount:r,skipConfirmStep:d,seatsPerTimeSlot:u,handleSlotClick:D,confirmButtonDisabled:f,confirmStepClassNames:g,...x})},e.date))]})]})};var tC=e.i(208013),tT=e.i(673610),tE=e.i(939988),tj=e.i(857739),tN=e.i(651855),t_=e.i(581325),tI=e.i(259385);let tB=({date:e,timeFormat:t,timeZone:a,language:r})=>{let o=new Date(e),s=(0,tI.formatDateTime)(o,{locale:r,timeZone:a,dateStyle:"full"}),n=(0,tI.formatDateTime)(o,{locale:r,timeZone:a,timeStyle:"short",hour12:t===eT.TimeFormat.TWELVE_HOUR});return{date:s,time:t===eT.TimeFormat.TWELVE_HOUR?n.toLowerCase():n}},tO=e=>{let t=(({date:e,duration:t,timeFormat:a,timeZone:r,language:o})=>{let s=new Date(e),n=t?new Date(new Date(e).setMinutes(s.getMinutes()+t)):s,i=(0,tI.formatDateTimeRange)(s,n,{locale:o,timeZone:r,dateStyle:"full"}),l=(0,tI.formatDateTimeRange)(s,n,{locale:o,timeZone:r,timeStyle:"short",hour12:a===eT.TimeFormat.TWELVE_HOUR});return{date:i,time:a===eT.TimeFormat.TWELVE_HOUR?l.toLowerCase():l}})(e);return(0,a.jsxs)(a.Fragment,{children:[t.date,(0,a.jsx)("br",{}),t.time]})},tL=e=>{let t=tB(e);return(0,a.jsxs)(a.Fragment,{children:[t.date,", ",t.time]})};var tD=e.i(315138),tR=e.i(194752),tM=e.i(24798),tP=e.i(232591),tA=e.i(155044),tU=e.i(848553);let tV=J.z.object({value:J.z.literal(tD.DefaultEventLocationTypeEnum.Phone),optionValue:J.z.string().optional()}),tF=({fields:e,locations:t,rescheduleUid:r,isDynamicGroupBooking:o,bookingData:s,isPaidEvent:n,paymentCurrency:l="USD"})=>{let{t:d,i18n:u}=(0,ef.useLocale)(),{watch:c,setValue:m,formState:f}=(0,G.useFormContext)(),g=c("responses.location"),h=r?"reschedule":"",p=(0,X.useBookerStore)(e=>e.isInstantMeeting),x=(0,i.useMemo)(()=>e.filter(e=>"phone"===e.type&&e.name!==tA.SystemField.Enum.location).map(e=>e.name),[e]),v=(0,i.useRef)(null),y=(e,t)=>`${e} (${Intl.NumberFormat(u.language,{style:"currency",currency:l}).format(t)})`;return(0,a.jsx)("div",{children:e.map((e,i)=>{if(p&&"location"===e.name)return null;let l=("system"===e.editable||"system-but-optional"===e.editable)&&!!r&&null!==s,u="user-readonly"===e.editable||l,c=!!e.hidden,b=e.views;if(b&&!b.find(e=>e.id===h))return null;if(e.name===tA.SystemField.Enum.rescheduleReason){if(null===s)return null;u=!1}if(e.name===tA.SystemField.Enum.smsReminderNumber){if(g?.value==="phone")return m(`responses.${tA.SystemField.Enum.smsReminderNumber}`,g?.optionValue),null;u=!1}if(e.name===tA.SystemField.Enum.guests&&(u=!1,c=!!o||!!e.hidden),e.name===tA.SystemField.Enum.notes&&null!==s)return null;if(e.name===tA.SystemField.Enum.location&&(u=!1),e.name===tA.SystemField.Enum.location&&"radioInput"===e.type){if(!e.optionsInputs)throw Error("radioInput must have optionsInputs");let a=e.optionsInputs,r=(0,tR.default)(t,d);r.forEach(e=>{let t=a[e.value];t&&(t.placeholder=e.inputPlaceholder)}),e.options=r.filter(e=>!!e)}if(e?.options){let t=(0,tD.getOrganizerInputLocationTypes)(),a={};e.options.forEach(e=>{e.value in a?a[e.value]++:a[e.value]=1}),e.options=e.options.map(e=>({...e,value:t.includes(e.value)&&a[e.value]>1?e.label:e.value}))}let k=e;if(n){var S;ea.fieldTypesConfigMap[e.type]?.supportsPricing&&(k=(e=>{if(!ea.fieldTypesConfigMap[e.type]?.supportsPricing||!e.label||!e.price)return e;let t="string"==typeof e.price?parseFloat(e.price):e.price,a=y(e.label,t);return{...e,label:a,...tP.fieldsThatSupportLabelAsSafeHtml.includes(e.type)&&e.labelAsSafeHtml?{labelAsSafeHtml:(0,tU.markdownToSafeHTML)(a)}:{labelAsSafeHtml:void 0}}})(e)),ea.fieldTypesConfigMap[e.type]?.optionsSupportPricing&&(S=k,k=ea.fieldTypesConfigMap[S.type]?.optionsSupportPricing&&S.options?{...S,options:S.options.map(e=>{let t=e.price;return t?{...e,label:y(e.label,t)}:e})}:S)}return(0,a.jsx)(tM.FormBuilderField,{className:"mb-4",field:{...k,hidden:c},readOnly:u,...e.name===tA.SystemField.Enum.location&&{onValueChange:({value:e})=>{(e=>{let t=tV.safeParse(e);if(!t.success)return;let{optionValue:a}=t.data,r=(a??"").trim();r&&r!==v.current&&(x.forEach(e=>{f.touchedFields?.responses?.[e]||m(`responses.${e}`,r,{shouldDirty:!1,shouldValidate:!1})}),v.current=r)})(e)}}},i)})})};var tz=e.i(451698);let tW=()=>(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(tz.SkeletonText,{className:"h-7 w-32"}),(0,a.jsx)(tz.SkeletonText,{className:"mt-2 h-7 w-full"}),(0,a.jsx)(tz.SkeletonText,{className:"mt-4 h-7 w-28"}),(0,a.jsx)(tz.SkeletonText,{className:"mt-2 h-7 w-full"}),(0,a.jsxs)("div",{className:"mt-12 flex h-7 w-full flex-row items-center gap-4",children:[(0,a.jsx)(tz.SkeletonText,{className:"inline h-4 w-4 rounded-full"}),(0,a.jsx)(tz.SkeletonText,{className:"inline h-7 w-32"})]}),(0,a.jsxs)("div",{className:"mt-2 flex h-7 w-full flex-row items-center gap-4",children:[(0,a.jsx)(tz.SkeletonText,{className:"inline h-4 w-4 rounded-full"}),(0,a.jsx)(tz.SkeletonText,{className:"inline h-7 w-28"})]}),(0,a.jsx)(tz.SkeletonText,{className:"mt-8 h-7 w-32"}),(0,a.jsx)(tz.SkeletonText,{className:"mt-2 h-7 w-full"}),(0,a.jsx)(tz.SkeletonText,{className:"mt-4 h-7 w-28"}),(0,a.jsx)(tz.SkeletonText,{className:"mt-2 h-7 w-full"}),(0,a.jsxs)("div",{className:"mt-6 flex flex-row gap-3",children:[(0,a.jsx)(tz.SkeletonText,{className:"ml-auto h-8 w-20"}),(0,a.jsx)(tz.SkeletonText,{className:"h-8 w-20"})]})]}),t$=({onCancel:e,eventQuery:t,onSubmit:r,errorRef:o,errors:s,loadingStates:l,renderConfirmNotVerifyEmailButtonCond:d,bookingForm:u,children:c,extraOptions:m,isVerificationCodeSending:f,isPlatform:g=!1,isTimeslotUnavailable:h,shouldRenderCaptcha:p,confirmButtonDisabled:x,classNames:v,timeslot:y})=>{let b=t.data,k=(0,n.useBookerStoreContext)(e=>e.setFormValues),S=(0,n.useBookerStoreContext)(e=>e.bookingData),w=(0,n.useBookerStoreContext)(e=>e.rescheduleUid),C=(0,n.useBookerStoreContext)(e=>e.username),T=(0,n.useBookerStoreContext)(e=>e.isInstantMeeting),E=e8(),{timeFormat:j,timezone:N}=(0,ey.useBookerTime)(),[_]=(0,i.useState)(null),{t:I,i18n:B}=(0,ef.useLocale)(),O=(0,i.useMemo)(()=>{if(!b?.price)return!1;let e=(0,tC.getPaymentAppData)(b);return b?.price>0&&!Number.isNaN(e.price)&&e.price>0},[b]),L=(0,i.useMemo)(()=>b&&(0,tC.getPaymentAppData)(b)?.currency||"USD",[b]);if(t.isError)return(0,a.jsx)(tE.Alert,{severity:"warning",message:I("error_booking_event")});if(t.isPending||!t.data)return(0,a.jsx)(tW,{});if(!y)return(0,a.jsx)(tN.EmptyScreen,{headline:I("timeslot_missing_title"),description:I("timeslot_missing_description"),Icon:"calendar",buttonText:I("timeslot_missing_cta"),buttonOnClick:e});if(!b)return console.warn("No event type found for event",m),(0,a.jsx)(tE.Alert,{severity:"warning",message:I("error_booking_event")});let D=u.watch("cfToken");return(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)(t_.Form,{className:"flex flex-col h-full",onChange:()=>{k(u.getValues())},form:u,handleSubmit:r,noValidate:!0,children:[(0,a.jsx)(tF,{isDynamicGroupBooking:!!(C&&C.indexOf("+")>-1),fields:b.bookingFields,locations:b.locations,rescheduleUid:w||void 0,bookingData:S,isPaidEvent:O,paymentCurrency:L}),s.hasFormErrors||s.hasDataErrors?(0,a.jsx)("div",{"data-testid":"booking-fail",children:(0,a.jsx)(tE.Alert,{ref:o,className:"my-2",severity:"info",title:I(w?"reschedule_fail":"booking_fail"),message:tY({globalError:s.formErrors,dataError:s.dataErrors,t:I,responseVercelIdHeader:_,timeFormat:j,timezone:N,language:B.language})})}):h?(0,a.jsx)("div",{"data-testid":"slot-not-allowed-to-book",children:(0,a.jsx)(tE.Alert,{severity:"info",title:I("unavailable_timeslot_title"),message:(0,a.jsx)(tT.default,{t:I,i18nKey:"timeslot_unavailable_book_a_new_time",components:[(0,a.jsx)("button",{type:"button",className:"underline",onClick:e,children:"Please select a new time"},"please-select-a-new-time-button")]})})}):null,!g&&(0,a.jsx)("div",{className:"my-3 w-full text-xs text-subtle",children:(0,a.jsx)(tT.default,{t:I,i18nKey:"signing_up_terms",values:{appName:eQ.APP_NAME},components:[(0,a.jsx)(td.default,{className:"text-emphasis hover:underline",href:`${eQ.WEBSITE_TERMS_URL}`,target:"_blank",children:"Terms"},"terms"),(0,a.jsx)(td.default,{className:"text-emphasis hover:underline",href:`${eQ.WEBSITE_PRIVACY_POLICY_URL}`,target:"_blank",children:"Privacy Policy."},"privacy")]})}),E&&(0,a.jsxs)("div",{className:"my-3 w-full text-xs text-subtle",children:[I("proceeding_agreement")," ",(0,a.jsx)(td.default,{className:"text-emphasis hover:underline",href:`${eQ.WEBSITE_TERMS_URL}`,target:"_blank",children:I("terms")},"terms")," ",I("and")," ",(0,a.jsx)(td.default,{className:"text-emphasis hover:underline",href:`${eQ.WEBSITE_PRIVACY_POLICY_URL}`,target:"_blank",children:I("privacy_policy")},"privacy"),"."]}),(0,a.jsx)("div",{className:"flex justify-end mt-auto space-x-2 modalsticky rtl:space-x-reverse",children:T?(0,a.jsx)(tj.Button,{type:"submit",color:"primary",loading:l.creatingInstantBooking,children:I(O?"pay_and_book":"confirm")}):(0,a.jsxs)(a.Fragment,{children:[!!e&&(0,a.jsx)(tj.Button,{color:"minimal",type:"button",onClick:e,"data-testid":"back",className:v?.backButton,children:I("back")}),(0,a.jsx)(tj.Button,{type:"submit",color:"primary",disabled:!!p&&!D||h||x,loading:l.creatingBooking||l.creatingRecurringBooking||f,className:v?.confirmButton,"data-testid":w&&S?"confirm-reschedule-button":"confirm-book-button",children:I(w&&S?"reschedule":d?O?"pay_and_book":"confirm":"verify_email_button")})]})})]}),c]})},tY=({globalError:e,dataError:t,t:r,responseVercelIdHeader:o,timeFormat:s,timezone:n,language:i})=>{if(e)return e?.message;let l="",d=0;if(t.message===eR.ErrorCode.BookerLimitExceededReschedule){let e=tB({date:t.data.startTime,timeFormat:s,timeZone:n,language:i});l=`${e.date} ${e.time}`}t.message===eR.ErrorCode.BookerLimitExceeded&&t.data?.count&&(d=t.data.count);let u=t.message===eR.ErrorCode.BookerLimitExceeded?"booker_upcoming_limit_reached":t.message;return t?.message?(0,a.jsxs)(a.Fragment,{children:[o??""," ",r(u,{date:l,count:d}),t.data?.traceId&&(0,a.jsxs)("div",{className:"mt-2 text-xs text-subtle",children:[(0,a.jsxs)("span",{className:"font-medium",children:[r("trace_reference_id"),":"]}),(0,a.jsx)("code",{className:"ml-1 font-mono break-all select-all",children:t.data.traceId})]})]}):(0,a.jsx)(a.Fragment,{children:r("can_you_try_again")})};var tH=e.i(266027),tZ=e.i(873485),tq=e.i(81822),tQ=e.i(898921),tK=e.i(121860),tG=e.i(320937);let tJ=(e,t)=>{if(!e)return null;let a=Math.floor(e/60),r="";(e%=60)>0&&(r=1===e?t("minute_one_short",{count:1}):t("multiple_duration_timeUnit_short",{count:e,unit:"minute"}));let o="";return(a>0&&(o=1===a?t("hour_one_short",{count:1}):t("multiple_duration_timeUnit_short",{count:a,unit:"hour"})),o&&r)?`${o} ${r}`:o||r},tX=({event:e})=>{let{t}=(0,ef.useLocale)(),r=(0,i.useRef)([]);(0,ev.useIsPlatform)();let[s,l,d]=(0,n.useBookerStoreContext)(e=>[e.selectedDuration,e.setSelectedDuration,e.state]),{ref:u,calculateScroll:c,leftVisible:m,rightVisible:f}=(0,tK.useShouldShowArrows)(),g="isDynamic"in e&&e.isDynamic,h=(0,o.useIsEmbed)();if((0,i.useEffect)(()=>{!s&&(e.metadata?.multipleDuration||g)&&l(e.length)},[s,l,e.metadata?.multipleDuration,e.length,g]),(0,i.useEffect)(()=>{let e=setTimeout(()=>{!h&&s&&r.current[s]&&r.current[s]?.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},100);return()=>clearTimeout(e)},[s,h]),!e?.metadata?.multipleDuration&&!g)return(0,a.jsx)(a.Fragment,{children:tJ(e.length,t)});let p=e?.metadata?.multipleDuration||[15,30,60,90];return e?.metadata?.hideDurationSelectorInBookingPage?(0,a.jsx)(a.Fragment,{children:tJ(s||e.length,t)}):s?(0,a.jsxs)("div",{className:"border-default relative mr-5 flex flex-row items-center justify-between rounded-md border",children:[m&&(0,a.jsxs)("button",{onClick:()=>{u.current&&(u.current.scrollLeft-=100)},className:"absolute bottom-0 left-0 flex",children:[(0,a.jsx)("div",{className:"bg-default flex h-9 w-5 items-center justify-end rounded-md",children:(0,a.jsx)(tG.ChevronLeftIcon,{className:"text-subtle h-4 w-4"})}),(0,a.jsx)("div",{className:"to-default flex h-9 w-5 bg-linear-to-l from-transparent"})]}),(0,a.jsx)("ul",{className:"bg-default no-scrollbar flex max-w-full items-center gap-0.5 overflow-x-auto rounded-md p-1",onScroll:e=>c(e),ref:u,children:p.filter(e=>"booking"!==d||e===s).map((e,o)=>(0,a.jsx)("li",{"data-testId":`multiple-choice-${e}mins`,"data-active":s===e?"true":"false",onClick:()=>l(e),ref:t=>r.current[e]=t,className:(0,tn.default)(s===e?"bg-emphasis":"hover:text-emphasis","text-default cursor-pointer rounded-[4px] px-3 py-1.5 text-sm leading-tight transition"),children:(0,a.jsx)("div",{className:"w-max",children:tJ(e,t)})},o))}),f&&(0,a.jsxs)("button",{onClick:()=>{u.current&&(u.current.scrollLeft+=100)},className:"absolute bottom-0 right-0 flex",children:[(0,a.jsx)("div",{className:"to-default flex h-9 w-5 bg-linear-to-r from-transparent"}),(0,a.jsx)("div",{className:"bg-default flex h-9 w-5 items-center justify-end rounded-md",children:(0,a.jsx)(tG.ChevronRightIcon,{className:"text-subtle h-4 w-4"})})]})]}):null},t0=({children:e,onCancel:t})=>{let{data:r}=(0,e0.useEvent)();return(0,a.jsx)(t2,{child:e,eventLength:r?.length,onCancel:t})},t1=({children:e,onCancel:t})=>{var r;let o,{data:s}=(r=(0,n.useBookerStoreContext)(e=>e.eventId),o=`/${tZ.V2_ENDPOINTS.eventTypes}/${r}`,(0,tH.useQuery)({queryKey:["use-event-by-id",r],queryFn:()=>tq.default?.get(o).then(e=>{if(e.data.status===tZ.SUCCESS_STATUS)return e.data.data;throw Error(e.data.error.message)})}));return(0,a.jsx)(t2,{child:e,eventLength:s?.lengthInMinutes,onCancel:t})},t2=({child:e,eventLength:t})=>{let{i18n:r,t:o}=(0,ef.useLocale)(),s=(0,n.useBookerStoreContext)(e=>e.selectedTimeslot),i=(0,n.useBookerStoreContext)(e=>e.selectedDuration),l=(0,n.useBookerStoreContext)(e=>e.recurringEventCount),{timeFormat:d,timezone:u}=(0,ey.useBookerTime)();return s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("h1",{className:"font-cal text-emphasis text-xl leading-5",children:[o("confirm_your_details")," "]}),(0,a.jsxs)("div",{className:"my-4 flex flex-wrap gap-2 rounded-md leading-none",children:[(0,a.jsx)(tQ.Badge,{variant:"grayWithoutHover",startIcon:"calendar",size:"lg",children:(0,a.jsx)(tL,{date:s,timeFormat:d,timeZone:u,language:r.language})}),(i||t)&&(0,a.jsx)(tQ.Badge,{variant:"grayWithoutHover",startIcon:"clock",size:"lg",children:(0,a.jsx)("span",{children:tJ(i||t,o)})}),l&&l>1&&(0,a.jsx)(tQ.Badge,{variant:"grayWithoutHover",startIcon:"refresh-ccw",size:"lg",children:(0,a.jsx)("span",{children:o("repeats_num_times",{count:l})})})]}),e]}):null},t4=({visible:e,onCancel:t,children:r})=>{let o=(0,ev.useIsPlatform)();return(0,a.jsx)(tr.Dialog,{open:e,onOpenChange:t,children:(0,a.jsx)(ti.DialogContent,{type:void 0,enableOverflow:!0,className:"[&_.modalsticky]:border-t-subtle [&_.modalsticky]:bg-default max-h-[80vh] pb-0 [&_.modalsticky]:sticky [&_.modalsticky]:bottom-0 [&_.modalsticky]:left-0 [&_.modalsticky]:right-0 [&_.modalsticky]:-mx-8 [&_.modalsticky]:border-t [&_.modalsticky]:px-8 [&_.modalsticky]:py-4",children:o?(0,a.jsx)(t1,{onCancel:t,children:r}):(0,a.jsx)(t0,{onCancel:t,children:r})})})};var t3=e.i(986263),t6=e.i(574153);let t5=({event:e,slots:t={},isLoading:r,classNames:s,scrollToTimeSlots:i,showNoAvailabilityDialog:d,onDateChange:u})=>{let{i18n:c}=(0,ef.useLocale)(),[m,f,g]=(0,n.useBookerStoreContext)(e=>[e.month,e.selectedDate,e.layout],l.shallow),[h,p,x]=(0,n.useBookerStoreContext)(e=>[e.setSelectedDate,e.setMonth,e.setDayCount],l.shallow),v=(0,o.useSlotsViewOnSmallScreen)(),y=e=>{p(e.format("YYYY-MM")),v||h({date:e.format("YYYY-MM-DD")}),x(null)},b=(0,to.useNonEmptyScheduleDays)(t),{moveToNextMonthOnNoAvailability:k}=(({browsingDate:e,nonEmptyScheduleDays:t,onMonthChange:a,isLoading:r})=>{if(r)return{moveToNextMonthOnNoAvailability:()=>{}};let o=t.filter(t=>(0,ek.default)(t).isSame(e,"month"));return{moveToNextMonthOnNoAvailability:()=>{(0,ek.default)().startOf("month").format("YYYY-MM")!=e.format("YYYY-MM")||o.length||a(e.add(1,"month"))}}})({browsingDate:m?(0,ek.default)(m):(0,ek.default)().startOf("month"),nonEmptyScheduleDays:b,onMonthChange:y,isLoading:r??!0});k();let S="month_view"!==g&&"mobile"!==g,w={periodType:"UNLIMITED",periodStartDate:null,periodEndDate:null,periodDays:null,periodCountCalendarDays:!1,...e?.data&&{periodType:e.data.periodType,periodStartDate:e.data.periodStartDate,periodEndDate:e.data.periodEndDate,periodDays:e.data.periodDays,periodCountCalendarDays:e.data.periodCountCalendarDays}};return(0,a.jsx)(t3.DatePicker,{customClassNames:{datePickerTitle:s?.datePickerTitle,datePickerDays:s?.datePickerDays,datePickersDates:s?.datePickerDate,datePickerDatesActive:s?.datePickerDatesActive,datePickerToggle:s?.datePickerToggle},className:s?.datePickerContainer,isLoading:r,onChange:(e,t)=>{let a=(null===e?null:e.format("YYYY-MM-DD"))!==f;h({date:null===e?null:e.format("YYYY-MM-DD"),omitUpdatingParams:t,preventMonthSwitching:!S}),a&&u?.()},onMonthChange:y,includedDates:b,locale:c.language,browsingDate:m?(0,ek.default)(m):void 0,selected:(0,ek.default)(f),weekStart:(0,t6.weekdayToWeekIndex)(e?.data?.subsetOfUsers?.[0]?.weekStart),slots:t,scrollToTimeSlots:i,periodData:w,isCompact:S,showNoAvailabilityDialog:d})},t8=({isEmbed:e})=>{let{t}=(0,ef.useLocale)(),[r,o]=(0,i.useState)(!0);return r?(0,a.jsx)("div",{onClick:()=>o(!1),className:`bg-default border-subtle fixed left-1/2 ${!e?"top-4":"top-0"} z-50 -translate-x-1/2 transform cursor-pointer items-center gap-3 rounded-xl border p-3 text-sm shadow-md`,children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)(tG.InfoIcon,{className:"h-5 w-5 text-orange-500"})}),(0,a.jsx)("div",{className:"text-emphasis font-medium","data-testid":"dry-run-msg",children:t("dry_run_mode_active")})]})}):null};var t7=e.i(67643),t9=e.i(528187),ae=e.i(37171),at=e.i(142047),aa=e.i(941739),ar=((t={})[t.DURATION=0]="DURATION",t[t.LOCATION=1]="LOCATION",t[t.REQUIRES_CONFIRMATION=2]="REQUIRES_CONFIRMATION",t[t.OCCURENCES=3]="OCCURENCES",t[t.PRICE=4]="PRICE",t),ao=e.i(633184),as=e.i(50929);let an=e=>!!e;function ai({eventLocationType:e,isTooltip:t}){let r=(0,ev.useIsPlatform)();return(0,a.jsx)("img",{src:`${r?"https://app.cal.com":""}${e.iconUrl}`,className:(0,tn.default)((0,ao.default)(e?.iconUrl,t),"me-[10px] h-4 w-4"),alt:`${e.label} icon`})}function al({locations:e}){let{t}=(0,ef.useLocale)();return(0,a.jsxs)("div",{className:"my-2 me-2 flex w-full flex-col stack-y-3 wrap-break-word",children:[(0,a.jsx)("p",{children:t("select_on_next_step")}),e.map((e,r)=>{let o=(0,tD.getEventLocationType)(e.type);if(!o)return null;let s=e.customLabel||(0,tD.getTranslatedLocation)(e,o,t);return(0,a.jsxs)("div",{className:"font-sm flex flex-row items-center",children:[(0,a.jsx)(ai,{eventLocationType:o,isTooltip:!0}),(0,a.jsx)("p",{className:"line-clamp-1",children:s})]},`${e.type}-${r}`)})]})}function ad({locations:e}){let{t}=(0,ef.useLocale)(),r=(0,ev.useIsPlatform)(),o=e.map((e,r)=>{let o=(0,tD.getEventLocationType)(e.type);if(!o)return null;let s=e?.customLabel||(0,tD.getTranslatedLocation)(e,o,t);return(0,a.jsxs)("div",{className:"flex flex-row items-center text-sm font-medium",children:["/link.svg"===o.iconUrl?(0,a.jsx)(tG.LinkIcon,{className:"text-default h-4 w-4 ltr:mr-[10px] rtl:ml-[10px]"}):(0,a.jsx)(ai,{eventLocationType:o,isTooltip:!1}),(0,a.jsx)(as.Tooltip,{content:s,children:(0,a.jsx)("p",{className:"line-clamp-1",children:s})})]},`${e.type}-${r}`)}).filter(an);return o.length>1?(0,a.jsxs)("div",{className:"flex flex-row items-center text-sm font-medium",children:[r?(0,a.jsx)(tG.MapPinIcon,{className:(0,tn.default)("me-[10px] h-4 w-4 opacity-70 dark:invert")}):(0,a.jsx)("img",{src:"/map-pin-dark.svg",className:(0,tn.default)("me-[10px] h-4 w-4 opacity-70 dark:invert"),alt:"map-pin"}),(0,a.jsx)(as.Tooltip,{content:(0,a.jsx)(al,{locations:e}),children:(0,a.jsx)("p",{className:"line-clamp-1",children:t("location_options",{locationCount:o.length})})})]}):1===o.length?(0,a.jsx)("div",{className:"text-default mr-6 flex w-full flex-col stack-y-4 wrap-break-word text-sm rtl:mr-2",children:o}):null}var au=e.i(402925),ac=e.i(493453),am=e.i(973895);let af=({event:e})=>{let t=e.recurringEvent?.count||null,{t:r,i18n:o}=(0,ef.useLocale)(),[s,l,d,u]=(0,n.useBookerStoreContext)(e=>[e.setRecurringEventCount,e.recurringEventCount,e.setRecurringEventCountQueryParam,e.recurringEventCountQueryParam]),c=(0,n.useBookerStoreContext)(e=>e.selectedTimeslot),m=(0,n.useBookerStoreContext)(e=>e.state),{timezone:f,timeFormat:g}=(0,ey.useBookerTime)(),[h,p]=(0,i.useState)(!1),x=e=>{let a=parseInt(e);!isNaN(a)&&a>=1&&null!==t&&a<=t?(s(a),p(!1)):(s(t),p(!0))};if((0,i.useEffect)(()=>{e.recurringEvent?.count&&(u?x(u):(s(t),d(t)))},[s,e.recurringEvent,l,u]),!e.recurringEvent)return null;if("booking"===m&&l&&c){let[t,s]=ej({startDate:c,timeZone:f,recurringEvent:e.recurringEvent,recurringCount:l,selectedTimeFormat:g},o.language),n=(0,ac.getTimeShiftFlags)({dates:s,timezone:f}),i=(0,ac.getFirstShiftFlags)(n);return(0,a.jsxs)("div",{"data-testid":"recurring-dates",children:[t.slice(0,5).map((e,t)=>(0,a.jsxs)("p",{children:[e,i[t]&&(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsx)(tQ.Badge,{variant:"orange",size:"sm",children:r("time_shift")})]})]},t)),t.length>5&&(0,a.jsx)(as.Tooltip,{content:t.slice(5).map((e,t)=>(0,a.jsxs)("p",{children:[e,i[t+5]&&(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsx)(tQ.Badge,{variant:"orange",size:"sm",children:r("time_shift")})]})]},t)),children:(0,a.jsxs)("p",{className:" text-sm",children:["+ ",r("plus_more",{count:t.length-5})]})})]})}return(0,a.jsxs)(a.Fragment,{children:[(0,au.getRecurringFreq)({t:r,recurringEvent:e.recurringEvent}),(0,a.jsx)("br",{}),(0,a.jsx)(am.Input,{className:"my-1 mr-3 inline-flex h-[26px] w-[46px] px-1 py-0",type:"number",min:"1",max:e.recurringEvent.count,defaultValue:u||e.recurringEvent.count,"data-testid":"occurrence-input",onChange:e=>{d(parseInt(e.target.value)),x(e.target.value)}}),r("occurrence",{count:l||e.recurringEvent.count}),h&&(0,a.jsx)("div",{className:"-ml-4 mr-4 mt-2 flex",children:(0,a.jsx)(tE.Alert,{severity:"warning",title:r("enter_number_between_range",{maxOccurences:t})})})]})};var ag=e.i(860031);let ah=[ar.REQUIRES_CONFIRMATION,ar.DURATION,ar.OCCURENCES,ar.LOCATION,ar.PRICE],ap=({customIcon:e,icon:t,iconUrl:r,children:o,highlight:s,contentClassName:n,className:l,isDark:d,...u})=>i.default.Children.count(o)?(0,a.jsxs)("div",{className:(0,tn.default)("flex items-start justify-start text-sm",s?"text-emphasis":"text-text",l),...u,children:[r?(0,a.jsx)("img",{src:r,alt:"",className:(0,tn.default)("mr-2 mt-[2px] h-4 w-4 shrink-0",void 0===d&&"filter-[invert(0.5)_brightness(0.5)]",(void 0===d||d)&&"dark:filter-[invert(0.65)_brightness(0.9)]")}):(0,a.jsx)(a.Fragment,{children:e||!!t&&(0,a.jsx)(aa.Icon,{name:t,className:"relative z-20 mr-2 mt-[2px] h-4 w-4 shrink-0 rtl:ml-2"})}),(0,a.jsx)("div",{className:(0,tn.default)("relative z-10 max-w-full wrap-break-word",n),children:o})]}):null,ax=({event:e,blocks:t=ah})=>{let{t:r}=(0,ef.useLocale)(),o=(0,X.useBookerStore)(e=>e.rescheduleUid),s=(0,X.useBookerStore)(e=>e.isInstantMeeting);return(0,a.jsx)(a.Fragment,{children:t.map(t=>{if("function"==typeof t)return(0,a.jsx)(i.Fragment,{children:t(e)},t.name);switch(t){case ar.DURATION:return(0,a.jsx)(ap,{icon:"clock",className:"items-center",children:(0,a.jsx)(tX,{event:e})},t);case ar.LOCATION:if(!e?.locations?.length||s||e.enablePerHostLocations)return null;return(0,a.jsx)(ap,{children:(0,a.jsx)(ad,{locations:e.locations})},t);case ar.REQUIRES_CONFIRMATION:if(!e.requiresConfirmation)return null;return(0,a.jsx)(ap,{icon:"square-check",children:r("requires_confirmation")},t);case ar.OCCURENCES:if(!e.recurringEvent||o)return null;return(0,a.jsx)(ap,{icon:"refresh-ccw",children:(0,a.jsx)(af,{event:e})},t);case ar.PRICE:let n=(0,tC.getPaymentAppData)(e);if(e.price<=0||n.price<=0)return null;return(0,a.jsx)(ap,{customIcon:(0,a.jsx)(at.PriceIcon,{className:"relative z-20 mr-2 mt-[2px] h-4 w-4 shrink-0 rtl:ml-2",currency:e.currency}),children:(0,a.jsx)(ag.Price,{price:n.price,currency:e.currency,displayAlternateSymbol:!1})},t)}})})};var av=e.i(102209),ay=e.i(770703),ab=e.i(897026);let ak=({children:e,as:t,className:r})=>(0,a.jsx)(t||"h1",{"data-testid":"event-title",className:(0,tn.default)("text-text break-words text-xl font-semibold",r),children:e}),aS=()=>(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(tz.SkeletonText,{className:"h-6 w-6 rounded-full"}),(0,a.jsx)(tz.SkeletonText,{className:"mt-2 h-5 w-32"}),(0,a.jsx)(tz.SkeletonText,{className:"mt-2 h-8 w-48"}),(0,a.jsx)("div",{className:"mt-8",children:Array.from({length:4}).map((e,t)=>(0,a.jsxs)("div",{className:"mb-2 flex flex-row items-center",children:[(0,a.jsx)(tz.SkeletonText,{className:"mr-3 h-5 w-5 rounded-full"}),(0,a.jsx)(tz.SkeletonText,{className:(0,tn.default)("h-6",t>1?"w-24":"w-32")})]},t))})]});var aw=e.i(359900),aC=e.i(798358),aT=e.i(216674),aE=e.i(596961);let aj=({schedulingType:e,users:t,profile:r,entity:s,isPrivateLink:n,roundRobinHideOrgAndTeam:i,hideOrgTeamAvatar:l})=>{let d=(0,X.useBookerStore)(e=>e.username),u=!!(d&&d.indexOf("+")>-1),c=(0,o.useIsEmbed)(),m=(0,ev.useIsPlatform)(),f=e!==eP.SchedulingType.ROUND_ROBIN?t:[],g=r.name&&e===eP.SchedulingType.ROUND_ROBIN||!t.length||r.name!==t[0].name&&e===eP.SchedulingType.COLLECTIVE;if(e===eP.SchedulingType.ROUND_ROBIN&&i)return(0,a.jsx)("div",{className:"h-6"});if(e===eP.SchedulingType.ROUND_ROBIN&&l)return(0,a.jsx)("p",{className:"text-subtle pt-6 text-sm font-semibold",children:r.name});let h=!l&&!u&&(r.image||s.logoUrl)&&s.teamSlug?[{href:c||m||n||s.hideProfileLink?null:s.teamSlug?(0,aC.getTeamUrlSync)({orgSlug:s.orgSlug,teamSlug:s.teamSlug}):(0,aw.getBookerBaseUrlSync)(s.orgSlug),image:s.logoUrl??r.image??"",alt:s.name??r.name??"",title:s.name??r.name??""}]:[];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(aE.AvatarGroup,{size:"sm",className:"border-muted",items:[...h,...f.map(e=>({href:m||n||s.hideProfileLink?null:`${(0,aw.getBookerBaseUrlSync)(e.profile?.organization?.slug??null)}/${e.profile?.username}?redirect=false`,alt:e.name||"",title:e.name||"",image:(0,aT.getUserAvatarUrl)(e)}))]}),(0,a.jsx)("p",{className:"text-subtle mt-2 text-sm font-semibold",children:g?r.name:f.map(e=>e.name).filter(e=>e).join(", ")})]})};function aN({children:e,className:t,ariaLabel:r}){let[o,s]=(0,i.useState)({top:!1,bottom:!1}),n=(0,i.useRef)(null),l=(0,i.useCallback)(()=>{let e=n.current;if(!e)return;let{scrollTop:t,scrollHeight:a,clientHeight:r}=e,o=t>5,i=t+r<a-5;s(e=>e.top===o&&e.bottom===i?e:{top:o,bottom:i})},[]),d=(0,i.useCallback)(e=>{n.current=e,l()},[l]);return(0,i.useEffect)(()=>{let e=n.current;if(!e)return;let t=new ResizeObserver(l);return t.observe(e),()=>t.disconnect()},[l]),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{ref:d,onScroll:l,className:t,tabIndex:0,role:"region","aria-label":r,children:e}),o.top&&(0,a.jsx)("div",{className:"from-default pointer-events-none absolute left-0 right-0 top-0 h-8 bg-gradient-to-b to-transparent dark:from-[var(--cal-bg-muted)]","aria-hidden":"true"}),o.bottom&&(0,a.jsx)("div",{className:"from-default pointer-events-none absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t to-transparent dark:from-[var(--cal-bg-muted)]","aria-hidden":"true"})]})}let a_=(0,ay.default)(()=>e.A(933503).then(e=>e.TimezoneSelect),{loadableGenerated:{modules:[993225]},ssr:!1}),aI=(e,t,a)=>{let r=ab.default.locale.targets.concat([ab.default.locale.source]);return e?.find(e=>e.field===t&&r.includes(e.targetLocale)&&(a===e.targetLocale||a.split("-")[0]===e.targetLocale))?.translatedText},aB=({event:e,isPending:t,isPlatform:r=!0,isPrivateLink:o,classNames:s,locale:d,timeZones:u,children:c,selectedTimeslot:m,roundRobinHideOrgAndTeam:f,hideOrgTeamAvatar:g,hideEventTypeDetails:h=!1})=>{let{timeFormat:p,timezone:x}=(0,ey.useBookerTime)(),[v]=(0,eZ.useTimePreferences)(e=>[e.setTimezone]),[y]=(0,n.useBookerStoreContext)(e=>[e.setTimezone],l.shallow),b=(0,n.useBookerStoreContext)(e=>e.selectedDuration),k=(0,n.useBookerStoreContext)(e=>e.state),S=(0,n.useBookerStoreContext)(e=>e.bookingData),w=(0,n.useBookerStoreContext)(e=>e.rescheduleUid),[C,T]=(0,n.useBookerStoreContext)(e=>[e.seatedEventData,e.setSeatedEventData],l.shallow),{i18n:E,t:j}=(0,ef.useLocale)(),[N]=(0,i.useMemo)(()=>r?[t7.Timezone]:[a_],[r]);if((0,i.useEffect)(()=>{if(e?.lockTimeZoneToggleOnBookingPage){let t=e.lockedTimeZone||e.schedule?.timeZone;t&&v(t)}},[e,v]),h)return null;let _=C?.attendees||S?.attendees.length,I=C?.seatsPerTimeSlot||e?.seatsPerTimeSlot,B=_&&I&&_/I>=.5,O=_&&I&&_/I>=.83,L=d??navigator.language,D=aI(e?.fieldTranslations??[],eP.EventTypeAutoTranslatedField.DESCRIPTION,L),R=aI(e?.fieldTranslations??[],eP.EventTypeAutoTranslatedField.TITLE,L);return(0,a.jsxs)("div",{className:`${s?.eventMetaContainer||""} relative z-10 p-6`,"data-testid":"event-meta",children:[t&&(0,a.jsx)(tf.m.div,{...$,initial:"visible",layout:!0,children:(0,a.jsx)(aS,{})}),!t&&!!e&&(0,a.jsxs)(tf.m.div,{...$,layout:!0,transition:{...$.transition,delay:.3},children:[(0,a.jsx)(aj,{schedulingType:e.schedulingType,users:e.subsetOfUsers,profile:e.profile,entity:e.entity,isPrivateLink:o,roundRobinHideOrgAndTeam:f,hideOrgTeamAvatar:g}),(0,a.jsx)(ak,{className:`${s?.eventMetaTitle} my-2`,children:R??e?.title}),(e.description||D)&&(0,a.jsx)(ap,{"data-testid":"event-meta-description",contentClassName:"mb-8",children:(0,a.jsx)(aN,{className:"wrap-break-word scroll-bar max-h-[180px] max-w-full overflow-y-auto pr-4",ariaLabel:j("description"),children:(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,t9.markdownToSafeHTMLClient)(D??e.description)}})})}),(0,a.jsxs)("div",{className:"stack-y-4 font-medium rtl:-mr-2",children:[w&&S&&(0,a.jsxs)(ap,{icon:"calendar",children:[j("former_time"),(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"line-through","data-testid":"former_time_p",children:(0,a.jsx)(tO,{date:S.startTime.toString(),duration:null,timeFormat:p,timeZone:x,language:E.language})})]}),m&&(0,a.jsx)(ap,{icon:"calendar",children:(0,a.jsx)(tO,{date:m,duration:b||e.length,timeFormat:p,timeZone:x,language:E.language})}),(0,a.jsx)(ax,{event:e}),(0,a.jsx)(ap,{className:"cursor-pointer [&_.current-timezone:before]:focus-within:opacity-100 [&_.current-timezone:before]:hover:opacity-100",contentClassName:"relative max-w-[90%]",icon:"globe",children:"booking"===k?(0,a.jsx)(a.Fragment,{children:x}):(0,a.jsx)("span",{className:`current-timezone before:bg-subtle min-w-32 -mt-[2px] flex h-6 max-w-full items-center justify-start before:absolute before:inset-0 before:bottom-[-3px] before:left-[-30px] before:top-[-3px] before:w-[calc(100%+35px)] before:rounded-md before:py-3 before:opacity-0 before:transition-opacity ${e.lockTimeZoneToggleOnBookingPage?"cursor-not-allowed":""}`,"data-testid":"event-meta-current-timezone",children:(0,a.jsx)(N,{timeZones:u,menuPosition:"absolute",timezoneSelectCustomClassname:s?.eventMetaTimezoneSelect,classNames:{control:()=>"min-h-0! p-0 w-full border-0 bg-transparent focus-within:ring-0 shadow-none!",menu:()=>"w-64! max-w-[90vw] mb-1 ",singleValue:()=>"text-text py-1",indicatorsContainer:()=>"ml-auto",container:()=>"max-w-full"},value:e.lockTimeZoneToggleOnBookingPage?e.lockedTimeZone||ae.CURRENT_TIMEZONE:x,onChange:({value:e})=>{v(e),y(e)},isDisabled:e.lockTimeZoneToggleOnBookingPage})})}),"booking"===k&&I&&_?(0,a.jsx)(ap,{icon:"user",className:`${O?"text-rose-600":B?"text-yellow-500":"text-bookinghighlight"}`,children:(0,a.jsx)("div",{className:"text-bookinghighlight flex items-start text-sm",children:(0,a.jsx)("p",{children:(0,a.jsx)(av.SeatsAvailabilityText,{showExact:!!C.showAvailableSeatsCount,totalSeats:I,bookedSeats:_||0,variant:"fraction"})})})}):null]}),c&&(0,a.jsx)("div",{className:s?.eventMetaChildren,children:c})]})]})};function aO(e){let{t}=(0,ef.useLocale)(),[r,o]=(0,i.useState)(!1);return e.visible&&("0"!=U.default.env.NEXT_PUBLIC_BOOKER_NUMBER_OF_DAYS_TO_LOAD||0!=eQ.BOOKER_NUMBER_OF_DAYS_TO_LOAD)&&U.default.env.NEXT_PUBLIC_BOOKER_NUMBER_OF_DAYS_TO_LOAD&&(!r||e.isScheduleLoading)&&!e.isScheduleLoading&&e.dayCount?(0,a.jsxs)("div",{className:"bg-default border-subtle mt-6 flex w-1/2 min-w-0 items-center justify-between rounded-[32px] border p-3 text-sm leading-none shadow-sm lg:w-1/3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 overflow-x-hidden",children:[(0,a.jsx)(tG.InfoIcon,{className:"text-default h-4 w-4"}),(0,a.jsx)("p",{className:"w-full  leading-none",children:t("having_trouble_finding_time")})]}),(0,a.jsxs)("button",{className:"inline-flex items-center gap-2 font-medium",onClick:t=>{t.preventDefault(),e.onButtonClick(),o(!0)},children:[t("show_more")," ",(0,a.jsx)(tG.ArrowRightIcon,{className:"h-4 w-4"})]})]}):null}var aL=e.i(246960),aD=e.i(755105),aR=e.i(862966);function aM({extraDays:e,isMobile:t,enabledLayouts:r,nextSlots:s,eventSlug:d,isMyLink:u,renderOverlay:c,isCalendarView:m}){var f;let g,h,p,{t:x,i18n:v}=(0,ef.useLocale)(),y=(0,o.useIsEmbed)(),b=(0,ev.useIsPlatform)(),[k,S]=(0,n.useBookerStoreContext)(e=>[e.layout,e.setLayout],l.shallow),w=(0,n.useBookerStoreContext)(e=>e.selectedDate),C=(0,n.useBookerStoreContext)(e=>e.setSelectedDate),T=(0,n.useBookerStoreContext)(e=>e.addToSelectedDate),E=void 0!==m?!m:k===z.BookerLayouts.MONTH_VIEW,j=(0,ek.default)(),N=w?(0,ek.default)(w):j,_=(0,i.useMemo)(()=>{let e=j.diff(N,"days");return e>3||e<-3},[j,N]);f=m??!1,g=(0,o.useSlotsViewOnSmallScreen)(),h=(0,ek.default)().startOf("week").format("YYYY-MM-DD"),p=(0,n.useBookerStoreContext)(e=>e.setSelectedDate),(0,i.useEffect)(()=>{!g&&b&&f&&p({date:h,omitUpdatingParams:!0})},[]);let I=(0,i.useCallback)(e=>{k!==e&&e&&S(e)},[S,k]);if(t||!r)return null;if(E)return(0,a.jsxs)("div",{className:"flex gap-2",children:[u&&!y?(0,a.jsx)(as.Tooltip,{content:x("troubleshooter_tooltip"),side:"bottom",children:(0,a.jsx)(tj.Button,{color:"primary",target:"_blank",href:`${eQ.WEBAPP_URL}/availability/troubleshoot?eventType=${d}`,children:x("need_help")})}):c?.(),(0,a.jsx)(aA,{layout:k,enabledLayouts:r,onLayoutToggle:I})]});let B=N.add(k===z.BookerLayouts.COLUMN_VIEW?e:e-1,"days"),O=()=>N.format("YYYY")===B.format("YYYY"),L=e=>(0,tI.formatDateTime)(e,{locale:v.language??"en",month:"short"});return(0,a.jsxs)("div",{className:"border-default relative z-10 flex border-b px-5 py-4 ltr:border-l rtl:border-r",children:[(0,a.jsxs)("div",{className:"flex items-center gap-5 rtl:grow",children:[(0,a.jsx)(()=>(0,a.jsxs)("h3",{className:"min-w-[150px] text-base font-semibold leading-4",children:[L(N.toDate())," ",N.format("D"),!O()&&(0,a.jsxs)("span",{className:"text-subtle",children:[", ",N.format("YYYY")," "]}),"-"," ",N.format("MMM")!==B.format("MMM")&&L(B.toDate())," ",B.format("D"),","," ",(0,a.jsx)("span",{className:"text-subtle",children:O()?N.format("YYYY"):B.format("YYYY")})]}),{}),(0,a.jsxs)(aL.ButtonGroup,{children:[(0,a.jsx)(tj.Button,{className:"group rtl:ml-1 rtl:rotate-180",variant:"icon",color:"minimal",StartIcon:"chevron-left","aria-label":"Previous Day",onClick:()=>T(k===z.BookerLayouts.COLUMN_VIEW?-s:-e)}),(0,a.jsx)(tj.Button,{className:"group rtl:mr-1 rtl:rotate-180",variant:"icon",color:"minimal",StartIcon:"chevron-right","aria-label":"Next Day",onClick:()=>T(k===z.BookerLayouts.COLUMN_VIEW?s:e)}),_&&(0,a.jsx)(tj.Button,{className:"capitalize ltr:ml-2 rtl:mr-2",color:"secondary",onClick:()=>{C({date:(m?j.startOf("week"):j).format("YYYY-MM-DD")})},children:x("today")})]})]}),(0,a.jsxs)("div",{className:"ml-auto flex gap-2",children:[c?.(),(0,a.jsx)(aR.TimeFormatToggle,{}),(0,a.jsx)("div",{className:"fixed top-4 ltr:right-4 rtl:left-4",children:(0,a.jsx)(aA,{layout:k,enabledLayouts:r,onLayoutToggle:I})}),(0,a.jsx)("div",{className:"pointer-events-none opacity-0","aria-hidden":!0,children:(0,a.jsx)(aA,{layout:k,enabledLayouts:r,onLayoutToggle:I})})]})]})}let aP=({onLayoutToggle:e,layout:t,enabledLayouts:r})=>{let s=(0,o.useIsEmbed)(),n=(0,ev.useIsPlatform)(),{t:l}=(0,ef.useLocale)(),d=(0,i.useMemo)(()=>[{value:z.BookerLayouts.MONTH_VIEW,label:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tG.CalendarIcon,{className:"h-4 w-4"}),(0,a.jsxs)("span",{className:"sr-only",children:["$",l("switch_monthly")]})]}),tooltip:l("switch_monthly")},{value:z.BookerLayouts.WEEK_VIEW,label:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tG.Grid3x3Icon,{className:"h-4 w-4"}),(0,a.jsxs)("span",{className:"sr-only",children:["$",l("switch_weekly")]})]}),tooltip:l("switch_weekly")},{value:z.BookerLayouts.COLUMN_VIEW,label:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tG.Columns3Icon,{className:"h-4 w-4"}),(0,a.jsxs)("span",{className:"sr-only",children:["$",l("switch_columnview")]})]}),tooltip:l("switch_columnview")}].filter(e=>r?.includes(e.value)),[l,r]);return s||n?null:(0,a.jsx)(aD.ToggleGroup,{onValueChange:e,defaultValue:t,"aria-label":l("layout"),options:d})},aA=({enabledLayouts:e,onLayoutToggle:t,layout:r})=>e.length<=1?null:(0,a.jsx)(aP,{onLayoutToggle:t,layout:r,enabledLayouts:e});var aU=e.i(441567);function aV(e){let{users:t,organization:r,disableHref:s=!1,...n}=e,i=[{href:(0,o.useIsEmbed)()||s?null:(0,aw.getBookerBaseUrlSync)(r.slug),image:(0,aU.getPlaceholderAvatar)(r.logoUrl,r.name),alt:r.name||void 0,title:r.name}].concat(t.map(e=>({href:s?null:`${e.bookerUrl}/${e.username}?redirect=false`,image:(0,aT.getUserAvatarUrl)(e),alt:e.name||void 0,title:e.name||e.username||""})));return(0,a.jsx)(aE.AvatarGroup,{...n,items:i})}let aF=({onConnectNow:e,event:t,cooldownMs:r=0})=>{let{t:o}=(0,ef.useLocale)(),s=r>0;return(0,a.jsxs)("div",{className:" bg-default border-subtle mx-2 block items-center gap-3 rounded-xl border p-[6px] text-sm shadow-sm delay-1000 sm:flex",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 ps-1",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(aV,{size:"sm",className:"border-muted",organization:{slug:t.entity.orgSlug,name:t.entity.name||"",logoUrl:t.entity.logoUrl??null},users:t.subsetOfUsers.slice(0,2),disableHref:!0}),(0,a.jsx)("div",{className:"border-muted absolute -bottom-0.5 -right-1 h-2 w-2 rounded-full border bg-green-500"})]}),(0,a.jsx)("div",{children:o("dont_want_to_wait")})]}),(0,a.jsx)("div",{className:"mt-2 flex items-center gap-3 sm:mt-0",children:s?(0,a.jsx)(as.Tooltip,{content:o("just_connected_description"),children:(0,a.jsx)("span",{className:"inline-flex",children:(0,a.jsx)(tj.Button,{disabled:s,color:"primary",onClick:()=>{e()},size:"sm",className:"w-full justify-center rounded-lg sm:w-auto",children:o("connect_now")})})}):(0,a.jsx)(tj.Button,{color:"primary",onClick:()=>{e()},size:"sm",className:"w-full justify-center rounded-lg sm:w-auto",children:o("connect_now")})})]})};var az=e.i(896297),aW=e.i(219731),a$=e.i(134019);let aY=({extraDays:e,schedule:t,isLoading:r,event:o})=>{let s=(0,n.useBookerStoreContext)(e=>e.selectedDate),l=(0,n.useBookerStoreContext)(e=>e.setSelectedTimeslot),d=(0,n.useBookerStoreContext)(e=>e.selectedDuration),u=(0,eH.useOverlayCalendarStore)(e=>e.overlayBusyDates),c="true"===(0,q.getQueryParam)("overlayCalendar")||eM.localStorage?.getItem("overlayCalendarSwitchDefault"),{timezone:m}=(0,ey.useBookerTime)(),f=d||o?.data?.length||30,g=(0,az.useAvailableTimeSlots)({schedule:t,eventDuration:f}),h=s?(0,ek.default)(s).toDate():(0,ek.default)().toDate(),p=(0,ek.default)(h).add(e-1,"day").toDate();(0,i.useEffect)(()=>{},[c]);let x=(0,i.useMemo)(()=>u&&c?u.map((e,t)=>({id:t,start:(0,ek.default)(e.start).toDate(),end:(0,ek.default)(e.end).toDate(),title:"Busy",options:{status:"ACCEPTED",borderOnly:!0}})):[],[u,c]);return(0,a.jsx)("div",{className:"h-full [--calendar-dates-sticky-offset:66px]",children:(0,a.jsx)(aW.Calendar,{isPending:r,availableTimeslots:g,startHour:0,endHour:23,events:x,startDate:h,endDate:p,onEmptyCellClick:e=>l(e.toISOString()),gridCellsPerHour:60/f,hoverEventDuration:f,hideHeader:!0,timezone:m,renderOutOfOffice:e=>(0,a.jsx)(a$.OutOfOfficeInSlots,{...e})})})};function aH(e){let{t}=(0,ef.useLocale)();return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(tr.Dialog,{open:e.open,onOpenChange:e.onClose,children:(0,a.jsxs)(ti.DialogContent,{type:"creation",title:t("overlay_my_calendar"),description:t("overlay_my_calendar_toc"),children:[(0,a.jsx)("div",{className:"flex flex-col gap-2",children:(0,a.jsx)(tj.Button,{"data-testid":"overlay-calendar-continue-button",onClick:()=>{e.onContinue()},className:"gap w-full items-center justify-center font-semibold",StartIcon:"calendar-search",children:t("continue_with",{appName:eQ.APP_NAME})})}),(0,a.jsx)(ti.DialogFooter,{children:(0,a.jsx)(a.Fragment,{})})]})})})}var aZ=e.i(571434),aq=e.i(398778),aQ=e.i(657688);let aK=()=>(0,a.jsx)(tz.SkeletonContainer,{children:(0,a.jsxs)("div",{className:"stack-y-4 mt-3 rounded-xl border border-subtle px-4 py-4",children:[(0,a.jsx)(tz.SkeletonText,{className:"h-4 w-full"}),(0,a.jsx)(tz.SkeletonText,{className:"h-4 w-full"}),(0,a.jsx)(tz.SkeletonText,{className:"h-4 w-full"}),(0,a.jsx)(tz.SkeletonText,{className:"h-4 w-full"})]})});function aG({open:e,onClose:t,onClickNoCalendar:r,onToggleConnectedCalendar:o,checkIsCalendarToggled:s}){let n,{t:l}=(0,ef.useLocale)(),d=(0,ev.useIsPlatform)(),{data:u,isPending:c}=eA.trpc.viewer.calendars.connectedCalendars.useQuery(void 0,{enabled:!!e});return n=c?(0,a.jsx)(aK,{}):u?.connectedCalendars.length===0?(0,a.jsx)(tN.EmptyScreen,{Icon:"calendar",headline:l("no_calendar_installed"),description:l("no_calendar_installed_description"),buttonText:l("add_a_calendar"),buttonOnClick:r}):u?.connectedCalendars.map(e=>(0,a.jsxs)(i.Fragment,{children:[e.error&&!e.calendars&&(0,a.jsx)(tE.Alert,{severity:"error",title:e.error.message}),e?.error===void 0&&e.calendars&&(0,a.jsxs)(aq.ListItem,{className:"flex-col rounded-md",children:[(0,a.jsxs)("div",{className:"flex w-full flex-1 items-center space-x-3 pb-4 rtl:space-x-reverse",children:[e.integration.logo&&(0,a.jsx)(aQ.default,{className:(0,tn.default)("h-10 w-10",e.integration.logo.includes("-dark")&&"dark:invert"),width:40,height:40,src:d?`https://app.cal.com${e.integration.logo}`:e.integration.logo,alt:`${e.integration.title} logo`}),(0,a.jsxs)("div",{className:"grow truncate pl-2",children:[(0,a.jsx)(aq.ListItemTitle,{component:"h3",className:"space-x-2 rtl:space-x-reverse",children:(0,a.jsx)(td.default,{href:`/apps/${e.integration.slug}`,children:e.integration.name||e.integration.title})}),(0,a.jsx)(aq.ListItemText,{component:"p",children:e.primary?.email})]})]}),(0,a.jsx)("div",{className:"border-subtle w-full border-t pt-4",children:(0,a.jsx)("ul",{className:"stack-y-4",children:e.calendars.map((t,r)=>{let n=t.integrationTitle??`calendar-switch-${r}`;return(0,a.jsx)("li",{className:"flex gap-3",children:(0,a.jsx)(aZ.Switch,{id:n,label:t.name,checked:s(t.externalId,e.credentialId),onCheckedChange:()=>{o(t.externalId,e.credentialId)}})},n)})})})]})]},e.credentialId)),(0,a.jsx)(tr.Dialog,{open:e,onOpenChange:t,children:(0,a.jsxs)(ti.DialogContent,{enableOverflow:!0,type:"creation",title:l("calendar_settings"),className:"pb-4",description:l("view_overlay_calendar_events"),children:[(0,a.jsx)("div",{className:"no-scrollbar max-h-full overflow-y-scroll",children:n}),(0,a.jsx)("div",{className:"mt-4 flex gap-2 self-end",children:(0,a.jsx)(ti.DialogClose,{children:l("done")})})]})})}function aJ({enabled:e,hasSession:t,onStateChange:r}){let{t:o}=(0,ef.useLocale)(),s=(0,eH.useOverlayCalendarStore)(e=>e.setContinueWithProviderModal),l=(0,eH.useOverlayCalendarStore)(e=>e.setCalendarSettingsOverlayModal),d=(0,n.useBookerStoreContext)(e=>e.layout);return(0,i.useEffect)(()=>{!t&&e&&(r(!1),s(!0))},[t,e,s,r]),(0,a.jsxs)("div",{className:(0,tn.default)("hidden gap-2","week_view"===d||"column_view"===d?"xl:flex":"md:flex"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 pr-2",children:[(0,a.jsx)(aZ.Switch,{"data-testid":"overlay-calendar-switch",checked:e,id:"overlayCalendar",onCheckedChange:e=>{t?r(e):s(e)}}),(0,a.jsx)("label",{htmlFor:"overlayCalendar",className:"text-emphasis text-sm font-medium leading-none hover:cursor-pointer",children:o("overlay_my_calendar")})]}),t&&(0,a.jsx)(tj.Button,{size:"base","data-testid":"overlay-calendar-settings-button",variant:"icon",color:"secondary",StartIcon:"settings",onClick:()=>{l(!0)}})]})}let aX=({connectedCalendars:e,overlayBusyDates:t,onToggleCalendar:r,isOverlayCalendarEnabled:o,handleClickNoCalendar:s,handleSwitchStateChange:n,handleClickContinue:d,hasSession:u})=>{let c=(0,ev.useIsPlatform)(),{handleCloseContinueModal:m,handleCloseSettingsModal:f,isOpenOverlayContinueModal:g,isOpenOverlaySettingsModal:h,handleToggleConnectedCalendar:p,checkIsCalendarToggled:x}=(({connectedCalendars:e,overlayBusyDates:t,onToggleCalendar:a})=>{let{set:r,toggleValue:o,hasItem:s}=function(e,t){let[a,r]=(0,i.useState)(()=>{let a=eM.localStorage.getItem(e);return new Set(a?JSON.parse(a):t)});return(0,i.useEffect)(()=>{eM.localStorage.setItem(e,JSON.stringify(Array.from(a)))},[e,a]),{set:a,addValue:e=>{r(t=>new Set(t).add(e))},removeById:e=>{r(t=>{let a=new Set(t);return a.forEach(t=>{t.externalId===e&&a.delete(t)}),a})},toggleValue:e=>{let t=new Set;return r(a=>{let r=new Set(a),o=!1;return r.forEach(t=>{t.externalId===e.externalId&&(o=!0,r.delete(t))}),o||r.add(e),t=r,r}),t},hasItem:e=>Array.from(a).some(t=>t.externalId===e.externalId),clearSet:()=>{r(()=>new Set),eM.localStorage.removeItem(e)}}}("toggledConnectedCalendars",[]),[n,d]=(0,i.useState)(!1),[u,c]=(0,eH.useOverlayCalendarStore)(e=>[e.continueWithProviderModal,e.setContinueWithProviderModal],l.shallow),[m,f]=(0,eH.useOverlayCalendarStore)(e=>[e.calendarSettingsOverlayModal,e.setCalendarSettingsOverlayModal],l.shallow),g=(0,eH.useOverlayCalendarStore)(e=>e.setOverlayBusyDates),{timezone:h}=(0,eZ.useTimePreferences)();return(0,i.useEffect)(()=>{if(t){let e=(0,ek.default)(),a=(e.tz(h).utcOffset()-e.utcOffset())/60;g(t.map(e=>({...e,start:(0,ek.default)(e.start).add(a,"hours").toDate(),end:(0,ek.default)(e.end).add(a,"hours").toDate()})))}},[t]),(0,i.useEffect)(()=>{e&&0===r.size&&!n&&(e.forEach(e=>{e.calendars?.forEach(t=>{let a={credentialId:e.credentialId,externalId:t.externalId};t.primary&&o(a)})}),d(!0))},[s,r,n]),{isOpenOverlayContinueModal:u,isOpenOverlaySettingsModal:m,handleCloseContinueModal:e=>c(e),handleCloseSettingsModal:e=>f(e),handleToggleConnectedCalendar:(e,t)=>{let r=o({credentialId:t,externalId:e});g([]),a(r)},checkIsCalendarToggled:(e,t)=>s({credentialId:t,externalId:e})}})({connectedCalendars:e,overlayBusyDates:t,onToggleCalendar:r});return((0,i.useEffect)(()=>{o&&m(!1)},[o,m]),c&&e?.length===0)?null:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(aJ,{enabled:o,hasSession:u,onStateChange:n}),!c&&(0,a.jsx)(aH,{open:g&&!o,onClose:m,onContinue:d}),(0,a.jsx)(aG,{open:h,onClose:f,onToggleConnectedCalendar:p,onClickNoCalendar:()=>{s()},checkIsCalendarToggled:x})]})},a0=e=>(e.returnValue="/o","/o"),a1=({bookingUid:e,onGoBack:t,expiryTime:r,instantVideoMeetingUrl:o,orgName:s})=>{let n,l,d,{t:u}=(0,ef.useLocale)(),[c,m]=(0,i.useState)(p()),[f,g]=(0,i.useState)(!1),h=(0,ep.useRouter)();function p(){let e=(0,ek.default)();return Math.max((0,ek.default)(r).diff(e),0)}return(0,i.useEffect)(()=>{if(!r)return;let e=setInterval(()=>{m(p()),g(r&&new Date(r)<new Date)},1e3);return()=>{clearInterval(e)}},[r]),(0,i.useEffect)(()=>!r||f||o?void window.removeEventListener("beforeunload",a0):(window.addEventListener("beforeunload",a0),()=>{window.removeEventListener("beforeunload",a0)}),[r,f,o]),(0,i.useEffect)(()=>{o&&(window.removeEventListener("beforeunload",a0),h.push(o))},[o]),(0,a.jsx)(tr.Dialog,{open:!!e&&!!r,children:(0,a.jsx)(ti.DialogContent,{enableOverflow:!0,className:"py-8","data-testid":"instant-meeting-modal",children:(0,a.jsx)("div",{children:f?(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:u("please_book_a_time_sometime_later")}),(0,a.jsx)(tj.Button,{className:"mt-4",onClick:()=>{t()},color:"primary",children:u("schedule_instead")})]}):(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"font-medium",children:u("connecting_you_to_someone",{orgName:s})}),(0,a.jsx)("p",{className:"font-bold",children:u("please_do_not_close_this_tab")}),(0,a.jsx)("p",{className:"mt-2 font-medium",children:u("please_schedule_future_call",{seconds:(l=(n=ek.default.duration(c)).seconds(),d=n.minutes(),`${d}m ${l}s`)})}),(0,a.jsx)("div",{className:"mt-4 h-[414px]",children:(0,a.jsx)("iframe",{className:"mx-auto h-full w-[276px] rounded-lg",src:"https://cal.games/"})})]})})})})},a2={calendar:"[grid-area:calendar]",main:"[grid-area:main]",meta:"[grid-area:meta]",timeslots:"[grid-area:timeslots]",header:"[grid-area:header]"},a4=(0,i.forwardRef)(function({children:e,area:t,visible:r,className:o,...s},i){let l,d=(0,n.useBookerStoreContext)(e=>e.layout);return(l="string"==typeof t?a2[t]:a2[t[d]||t.default],r||void 0===r)?(0,a.jsx)(tf.m.div,{ref:i,className:(0,tn.default)(l,o),layout:!0,...s,children:e}):null}),a3=()=>{let{t:e}=(0,ef.useLocale)();return(0,a.jsx)("span",{className:"text-default text-sm",children:e("loading")})},a6=(0,ay.default)(()=>e.A(933503).then(e=>e.TimezoneSelect),{loadableGenerated:{modules:[993225]},ssr:!1,loading:()=>(0,a.jsx)(a3,{})}),a5=({onClick:e,event:t,isPlatform:r=!1,timeZones:o,selectedDate:s})=>{let{i18n:d}=(0,ef.useLocale)(),[u]=(0,eZ.useTimePreferences)(e=>[e.setTimezone]),[c,m]=(0,n.useBookerStoreContext)(e=>[e.timezone,e.setTimezone],l.shallow),[f]=(0,i.useMemo)(()=>r?[t7.Timezone]:[a6],[r]),g=(0,i.useMemo)(()=>{if(!s)return{dayOfWeek:"",fullDate:""};let e=(0,ek.default)(s);return{dayOfWeek:e.locale(d.language).format("dddd"),fullDate:e.locale(d.language).format("MMMM D, YYYY")}},[s,d.language]);return(0,a.jsx)("div",{className:"two-step-slot-selection-modal-header sticky top-0 z-10 -mx-4 mt-0 mb-4 flex flex-col border-subtle border-b bg-default px-8 pb-4",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2 pt-8",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("span",{className:"font-semibold text-emphasis text-lg",children:[(0,a.jsx)(tj.Button,{color:"minimal",StartIcon:"arrow-left",className:"mb-2 ml-[-42px] w-[40px]",onClick:e})," ",g.dayOfWeek]}),(0,a.jsx)("span",{className:"text-default text-sm",children:g.fullDate})]}),t&&(0,a.jsx)(ax,{event:t,blocks:[ar.DURATION]}),(0,a.jsxs)("div",{className:"mb-0 flex items-center gap-2 text-default text-sm",children:[(0,a.jsx)(tG.GlobeIcon,{className:"h-4 w-4 shrink-0 text-subtle"}),f&&(0,a.jsx)("span",{className:"-mt-[2px] flex h-6 min-w-32 max-w-full items-center justify-start",children:(0,a.jsx)(f,{timeZones:o,menuPosition:"fixed",classNames:{control:()=>"min-h-0! p-0 w-full border-0 bg-transparent focus-within:ring-0 shadow-none!",menu:()=>"w-64! max-w-[90vw] mb-1",singleValue:()=>"text-text py-1",indicatorsContainer:()=>"ml-auto",container:()=>"max-w-full"},value:t?.lockTimeZoneToggleOnBookingPage?t.lockedTimeZone||ae.CURRENT_TIMEZONE:c||ae.CURRENT_TIMEZONE,onChange:({value:e})=>{u(e),m(e)},isDisabled:t?.lockTimeZoneToggleOnBookingPage})})]})]})})},a8=({children:e,title:t})=>(0,a.jsx)("div",{className:"mx-auto w-full max-w-2xl",children:(0,a.jsxs)("div",{className:"border-subtle bg-default dark:bg-cal-muted overflow-hidden rounded-lg border p-10",children:[(0,a.jsx)("h2",{className:"font-cal mb-4 text-3xl",children:t}),e]})}),a7=()=>{let{t:e}=(0,ef.useLocale)();return(0,a.jsx)(a8,{title:e("404_page_not_found"),children:(0,a.jsx)("p",{className:"max-w-[50ch]",children:e("booker_event_not_found")})})};var a9=e.i(257547);let re=({username:e,eventSlug:t,hideBranding:s=!1,entity:m,isInstantMeeting:f=!1,onGoBackInstantMeeting:g,onConnectNowInstantMeeting:h,onOverlayClickNoCalendar:p,onClickOverlayContinue:x,onOverlaySwitchStateChange:v,sessionUsername:y,rescheduleUid:b,hasSession:k,extraOptions:S,bookings:w,verifyEmail:C,slots:T,calendars:E,bookerForm:j,event:N,bookerLayout:_,schedule:I,verifyCode:B,isPlatform:O,orgBannerUrl:L,customClassNames:D,areInstantMeetingParametersSet:R=!1,userLocale:M,hasValidLicense:P,isBookingDryRun:$,renderCaptcha:H,hashedLink:Z,confirmButtonDisabled:Q,timeZones:K,eventMetaChildren:G,roundRobinHideOrgAndTeam:J,hideOrgTeamAvatar:ee,showNoAvailabilityDialog:ea})=>{let er=(0,eK.useCompatSearchParams)(),eo=e8(),[es,en]=(0,n.useBookerStoreContext)(e=>[e.state,e.setState],l.shallow),ei=(0,n.useBookerStoreContext)(e=>e.selectedDate),[el,ed]=(0,n.useBookerStoreContext)(e=>[e.isSlotSelectionModalVisible,e.setIsSlotSelectionModalVisible],l.shallow),{shouldShowFormInDialog:eu,hasDarkBackground:ec,extraDays:ef,columnViewExtraDays:eg,isMobile:eh,layout:ep,hideEventTypeDetails:ex,isEmbed:ev,bookerLayouts:ey,slotsViewOnSmallScreen:eb}=_,[ew,eC]=(0,n.useBookerStoreContext)(e=>[e.seatedEventData,e.setSeatedEventData],l.shallow),{selectedTimeslot:eT,setSelectedTimeslot:eE,allSelectedTimeslots:ej}=T,[eN,e_]=(0,n.useBookerStoreContext)(e=>[e.dayCount,e.setDayCount],l.shallow),eI=(0,to.useNonEmptyScheduleDays)(I?.data?.slots).filter(e=>0>=(0,ek.default)(ei).diff(e,"day")),eB=eI.length<ef?(ef-eI.length+1)*7:0,eO=eI.slice(0,ef+1);if(0!==eI.length){let e=eO.length===ef+1?eO.length-2:eO.length-1;eg.current=Math.abs((0,ek.default)(ei).diff(eO[e],"day"))+eB}let eL=Math.abs((0,ek.default)(ei).diff(eO[eO.length-1],"day"))+eB,eD=((e,t)=>{let a,r,o=function(){F.hasReducedMotionListener.current||(0,V.initPrefersReducedMotion)();let[e]=(0,i.useState)(F.prefersReducedMotion.current);return e}(),[s,n]=(a=(0,u.useConstant)(()=>({current:null,animations:[]})),r=(0,u.useConstant)(()=>A(a)),(0,c.useUnmountEffect)(()=>{a.animations.forEach(e=>e.stop())}),[a,r]),l=window?.isEmbed?.();return(0,i.useEffect)(()=>{let a=Y[e][t]||Y[e].default;if(!s.current)return;let r={height:a?.height||"auto"},i={gridTemplateAreas:a?.gridTemplateAreas,width:a?.width||"auto",gridTemplateColumns:a?.gridTemplateColumns,gridTemplateRows:a?.gridTemplateRows,minHeight:a?.minHeight};if(o||"mobile"===e||l){let e={...i,...r};Object.keys(e).forEach(t=>{"height"===t?s.current.style.height="100vh"===r.height&&l?"100%":r.height:s.current.style[t]=e[t]})}else Object.keys(i).forEach(e=>{s.current.style[e]=i[e]}),n(s.current,r,{duration:.5,ease:(0,d.cubicBezier)(.4,0,.2,1)})},[n,l,s,e,o,t]),s})(ep,es),eR=(0,i.useRef)(null),eM=eG(),eP=eh?"div":tv,{bookerFormErrorRef:eA,key:eU,formEmail:eV,bookingForm:eF,errors:ez}=j,{handleBookEvent:eW,errors:e$,loadingStates:eY,expiryTime:eH,instantVideoMeetingUrl:eZ,instantConnectCooldownMs:eq,bookingUid:eJ}=w,eX=eF.watch("cfToken"),{isEmailVerificationModalVisible:e0,setEmailVerificationModalVisible:e1,handleVerifyEmail:e2,renderConfirmNotVerifyEmailButtonCond:e4,isVerificationCodeSending:e3}=C,{overlayBusyDates:e5,isOverlayCalendarEnabled:te,connectedCalendars:td,onToggleCalendar:tm}=E,tg=(0,i.useRef)(!1),th=(0,o.useEmbedUiConfig)(),tp=()=>{eb||eh&&!tg.current&&eR.current&&!th.disableAutoScroll&&(((e,t=!1)=>{let a,o=e.getBoundingClientRect().top;if(e.scrollIntoView({behavior:"smooth"}),!t)return;let s=(a=navigator.userAgent.toLowerCase()).includes("safari")&&!a.includes("chrome");ts(2,()=>{let t=e.getBoundingClientRect().top;if(s&&o===t){let t;t=e.getBoundingClientRect().top,r.sdkActionManager?.fire("__scrollByDistance",{distance:t})}})})(eR.current,ev),tg.current=!0)},tx=((e,t,a,r,o,s)=>{let n=e.getValues(),[l,d]=(0,i.useState)(!1),u=(0,X.useBookerStore)(e=>e.rescheduleUid);return(0,i.useEffect)(()=>{let e=async()=>{if(!o||s&&s.length>1)return void d(!1);try{let e=function({bookingFields:e,view:t,translateFn:a}){return em({schema:z.bookingResponses.and(et.default.record(et.default.any())),bookingFields:e,isPartialSchema:!1,view:t,checkOptional:!0,translateFn:a})}({bookingFields:o,view:u?"reschedule":"booking"}),t=await e.safeParseAsync(n.responses);d(t.success)}catch(e){d(!1)}},i=!a&&!r;"selecting_time"===t&&i&&e()},[n,o,u,t,r,a]),l})(eF,es,f,ep==z.BookerLayouts.WEEK_VIEW,N?.data?.bookingFields,N?.data?.locations),tb=!!(!(void 0!==U.default&&U.default.env?.NEXT_PUBLIC_IS_E2E)&&H&&eQ.CLOUDFLARE_SITE_ID&&"1"===eQ.CLOUDFLARE_USE_TURNSTILE_IN_BOOKER&&("booking"===es||"selecting_time"===es&&tx)),tk=e=>{eE(e),tx||ed(!1)};(0,e7.updateEmbedBookerState)({bookerState:es,slotsQuery:I}),(0,i.useEffect)(()=>{if(N.isPending)return en("loading");if(!ei)return en("selecting_date");if(!eT)return en("selecting_time");let e=!f&&ep!==z.BookerLayouts.WEEK_VIEW;return eT&&tx&&e?en("selecting_time"):en("booking")},[N.isPending,ei,eT,en,tx,ep,f]);let tS=eM?ej.filter(e=>!(({scheduleData:e,slotToCheckInIso:t,quickAvailabilityChecks:a})=>{if(a&&a.some(e=>e.utcStartIso===t&&"available"!==e.status))return!1;if(!e)return!0;let r=tt(t)?t.split("T")[0]:null;return!r||function({scheduleData:e,dateInGMT:t,slotToCheckInIso:a}){let r=(0,ek.default)(t).subtract(1,"day").format("YYYY-MM-DD"),o=(0,ek.default)(t).add(1,"day").format("YYYY-MM-DD"),s=e.slots[t],n=e.slots[r],i=e.slots[o];return!!(ta(s,a)||ta(n,a)||ta(i,a))}({scheduleData:e,dateInGMT:r,slotToCheckInIso:t})})({scheduleData:I?.data??null,slotToCheckInIso:e,quickAvailabilityChecks:T.quickAvailabilityChecks})):[],tC=(0,q.getQueryParam)("slot");(0,i.useEffect)(()=>{eE(tC||null)},[tC,eE]);let tT=e=>e4?eW(e):e2(),tE=(0,i.useMemo)(()=>"booking"!==es?null:(0,a.jsx)(t$,{timeslot:eT,shouldRenderCaptcha:tb,onCancel:()=>{eE(null),eQ.PUBLIC_INVALIDATE_AVAILABLE_SLOTS_ON_BOOKING_FORM&&I?.invalidate(),ew.bookingUid&&eC({...ew,bookingUid:void 0,attendees:void 0})},onSubmit:()=>e4?eW():e2(),errorRef:eA,errors:{...ez,...e$},isTimeslotUnavailable:!f&&tS.includes(eT||""),loadingStates:eY,renderConfirmNotVerifyEmailButtonCond:e4,bookingForm:eF,eventQuery:N,extraOptions:S,isVerificationCodeSending:e3,confirmButtonDisabled:Q,classNames:{confirmButton:D?.confirmStep?.confirmButton,backButton:D?.confirmStep?.backButton},isPlatform:O,children:!O&&(0,a.jsx)(a1,{expiryTime:eH,bookingUid:eJ,instantVideoMeetingUrl:eZ,onGoBack:()=>{g()},orgName:N.data?.entity?.name})},eU),[eA,eZ,es,eF,e$,N,eH,S,ez,eW,e2,eU,eY,g,e4,ew,eC,eE,O,tb,e3,tS]);return m.considerUnpublished&&!b?(0,a.jsx)(tl.UnpublishedEntity,{...m}):N.isSuccess&&!N.data?(0,a.jsx)(a7,{}):"loading"===es?null:(0,a.jsxs)(a.Fragment,{children:[N.data&&!O?(0,a.jsx)(e6.default,{eventType:N.data}):(0,a.jsx)(a.Fragment,{}),($||(0,eS.isBookingDryRun)(er))&&(0,a.jsx)(t8,{isEmbed:ev}),(0,a.jsxs)("div",{className:(0,tn.default)("main","text-default flex min-h-full w-full flex-col items-center",ep===z.BookerLayouts.MONTH_VIEW&&!ev&&"my-20 ",ep===z.BookerLayouts.MONTH_VIEW?"overflow-visible":"overflow-clip",`${D?.bookerWrapper}`),children:[(0,a.jsx)("div",{ref:eD,"data-testid":"booker-container",className:(0,tn.default)(...((e,t,a=!1)=>{let r=e=>a?"":e;return["[--booker-timeslots-width:240px] lg:[--booker-timeslots-width:280px]",e===z.BookerLayouts.MONTH_VIEW&&r("[--booker-meta-width:240px]"),e===z.BookerLayouts.MONTH_VIEW&&"booking"===t&&`[--booker-main-width:420px] ${r("lg:[--booker-meta-width:340px]")}`,e===z.BookerLayouts.MONTH_VIEW&&"booking"!==t&&`[--booker-main-width:480px] ${r("lg:[--booker-meta-width:280px]")}`,e!==z.BookerLayouts.MONTH_VIEW&&`[--booker-main-width:480px] [--booker-meta-width:340px] ${r("lg:[--booker-meta-width:424px]")}`]})(ep,es,ex),"bg-default dark:bg-cal-muted grid max-w-full items-start dark:scheme-dark sm:transition-[width] sm:duration-300 sm:motion-reduce:transition-none md:flex-row",(ep===z.BookerLayouts.MONTH_VIEW||ev)&&"border-subtle rounded-md",!ev&&"sm:transition-[width] sm:duration-300",ev&&ep===z.BookerLayouts.MONTH_VIEW&&"border-booker sm:border-booker-width",!ev&&ep===z.BookerLayouts.MONTH_VIEW&&"border-subtle border",`${D?.bookerContainer}`),children:(0,a.jsxs)(tc.AnimatePresence,{children:[!f&&(0,a.jsx)(a4,{area:"header",className:(0,tn.default)(ep===z.BookerLayouts.MONTH_VIEW&&"fixed top-4 z-10 ltr:right-4 rtl:left-4",(ep===z.BookerLayouts.COLUMN_VIEW||ep===z.BookerLayouts.WEEK_VIEW)&&"bg-default dark:bg-cal-muted sticky top-0 z-10"),children:O&&ep===z.BookerLayouts.MONTH_VIEW?(0,a.jsx)(a.Fragment,{}):(0,a.jsx)(aM,{isMyLink:e===y,eventSlug:t,enabledLayouts:ey.enabledLayouts,extraDays:ep===z.BookerLayouts.COLUMN_VIEW?eg.current:ef,isMobile:eh,nextSlots:eL,renderOverlay:()=>ev?null:(0,a.jsx)(aX,{isOverlayCalendarEnabled:te,connectedCalendars:td,overlayBusyDates:e5,onToggleCalendar:tm,hasSession:k,handleClickContinue:x,handleSwitchStateChange:v,handleClickNoCalendar:()=>{p()}})})}),(0,a.jsx)(eP,{className:(0,tn.default)("relative z-10 flex [grid-area:meta]"),children:(0,a.jsxs)(a4,{area:"meta",className:"max-w-screen flex w-full flex-col md:w-(--booker-meta-width)",children:[!ex&&L&&(0,a.jsx)("img",{loading:"eager",className:"-mb-9 h-auto w-full object-contain object-top ltr:rounded-tl-md rtl:rounded-tr-md sm:h-16 sm:object-cover",alt:"org banner",src:L}),!ex&&(0,a.jsx)(aB,{selectedTimeslot:eT,classNames:{eventMetaContainer:D?.eventMetaCustomClassNames?.eventMetaContainer,eventMetaTitle:D?.eventMetaCustomClassNames?.eventMetaTitle,eventMetaTimezoneSelect:D?.eventMetaCustomClassNames?.eventMetaTimezoneSelect},event:N.data,isPending:N.isPending,isPlatform:O,isPrivateLink:!!Z,locale:M,timeZones:K,roundRobinHideOrgAndTeam:J,hideOrgTeamAvatar:ee,hideEventTypeDetails:ex,children:G}),ep!==z.BookerLayouts.MONTH_VIEW&&("mobile"!==ep||"booking"!==es)&&(0,a.jsx)("div",{className:"mt-auto px-5 py-3",children:(0,a.jsx)(t5,{classNames:D?.datePickerCustomClassNames,event:N,slots:I?.data?.slots,isLoading:I.isPending,scrollToTimeSlots:tp,showNoAvailabilityDialog:ea,onDateChange:()=>{eb&&ed(!0)}})})]})},"meta"),(0,a.jsx)(a4,{area:"main",className:"sticky top-0 -ml-px h-full p-6 md:w-(--booker-main-width) md:border-l",...W,visible:"booking"===es&&!eu,children:tE},"book-event-form"),(0,a.jsx)(a4,{area:"main",visible:"booking"!==es&&ep===z.BookerLayouts.MONTH_VIEW,...W,initial:"visible",className:(0,tn.default)("md:border-subtle -ml-px h-full shrink px-5 py-3  lg:w-(--booker-main-width)",ex?"":"md:border-l"),children:(0,a.jsx)(t5,{classNames:D?.datePickerCustomClassNames,event:N,slots:I?.data?.slots,isLoading:I.isPending,scrollToTimeSlots:tp,showNoAvailabilityDialog:ea})},"datepicker"),(0,a.jsx)(a4,{area:"main",visible:ep===z.BookerLayouts.WEEK_VIEW,className:"border-subtle sticky top-0 -ml-px h-full md:border-l",...W,children:(0,a.jsx)(aY,{extraDays:ef,schedule:I.data,isLoading:I.isPending,event:N})},"enable-calendar"),(0,a.jsx)(a4,{area:{default:"main",month_view:"timeslots"},visible:!(eb&&eh)&&(ep!==z.BookerLayouts.WEEK_VIEW&&"selecting_time"===es||ep===z.BookerLayouts.COLUMN_VIEW),className:(0,tn.default)("border-subtle rtl:border-default flex h-full w-full flex-col overflow-x-auto px-5 py-3 pb-0 rtl:border-r ltr:md:border-l",ep===z.BookerLayouts.MONTH_VIEW&&"h-full overflow-hidden md:w-(--booker-timeslots-width)",ep!==z.BookerLayouts.MONTH_VIEW&&"sticky top-0"),ref:eR,...W,children:(0,a.jsx)(tw,{onAvailableTimeSlotSelect:tk,customClassNames:D?.availableTimeSlotsCustomClassNames,extraDays:ef,limitHeight:ep===z.BookerLayouts.MONTH_VIEW,schedule:I,isLoading:I.isPending,seatsPerTimeSlot:N.data?.seatsPerTimeSlot,unavailableTimeSlots:tS,showAvailableSeatsCount:N.data?.seatsShowAvailabilityCount,event:N,loadingStates:eY,renderConfirmNotVerifyEmailButtonCond:e4,isVerificationCodeSending:e3,onSubmit:tT,skipConfirmStep:tx,shouldRenderCaptcha:tb,watchedCfToken:eX,confirmButtonDisabled:Q,confirmStepClassNames:D?.confirmStep})},"timeslots")]})}),(0,a.jsx)(aO,{visible:"booking"!==es&&ep===z.BookerLayouts.MONTH_VIEW&&!eh,dayCount:eN,isScheduleLoading:I.isLoading,onButtonClick:()=>{e_(null)}}),"booking"!==es&&N.data?.showInstantEventConnectNowModal&&R&&(0,a.jsx)("div",{className:(0,tn.default)("animate-fade-in-up  z-40 my-2 opacity-0",ep===z.BookerLayouts.MONTH_VIEW&&ev?"":"fixed bottom-2"),style:{animationDelay:"1s"},children:(0,a.jsx)(aF,{event:N.data,cooldownMs:eq,onConnectNow:()=>{h()}})}),tb&&(0,a.jsx)("div",{className:"mb-6 mt-auto pt-6",children:(0,a.jsx)(e9.default,{appearance:"interaction-only",onVerify:e=>{eF.setValue("cfToken",e)}})}),!s&&(!O||eo)&&!tb&&(0,a.jsx)(tf.m.span,{className:(0,tn.default)("mb-6 mt-auto pt-6 [&_img]:h-[15px]",ec?"dark":"",ep===z.BookerLayouts.MONTH_VIEW?"block":"hidden"),children:(0,a.jsx)(tu,{logoOnly:!0,hasValidLicense:P})},"logo")]}),(0,a.jsx)(a.Fragment,{children:B&&eV?(0,a.jsx)(a9.VerifyCodeDialog,{isOpenDialog:e0,setIsOpenDialog:e1,email:eV,isUserSessionRequiredToVerify:!1,verifyCodeWithSessionNotRequired:B.verifyCodeWithSessionNotRequired,verifyCodeWithSessionRequired:B.verifyCodeWithSessionRequired,error:B.error,resetErrors:B.resetErrors,isPending:B.isPending,setIsPending:B.setIsPending}):(0,a.jsx)(a.Fragment,{})}),(0,a.jsx)(t4,{onCancel:()=>eE(null),visible:"booking"===es&&eu,children:tE}),(0,a.jsx)(tr.Dialog,{open:eh&&el,children:(0,a.jsxs)(ti.DialogContent,{type:void 0,enableOverflow:!0,className:"fixed! inset-0! top-0! left-0! h-screen! max-h-screen! w-screen! max-w-none! translate-x-0! translate-y-0! rounded-none! m-0! px-8 pt-0 pb-8",children:[(0,a.jsx)(a5,{onClick:()=>ed(!1),event:N.data,isPlatform:O,timeZones:K,selectedDate:ei}),(0,a.jsx)(tw,{onAvailableTimeSlotSelect:tk,customClassNames:D?.availableTimeSlotsCustomClassNames,extraDays:ef,limitHeight:ep===z.BookerLayouts.MONTH_VIEW,schedule:I,isLoading:I.isPending,seatsPerTimeSlot:N.data?.seatsPerTimeSlot,unavailableTimeSlots:tS,showAvailableSeatsCount:N.data?.seatsShowAvailabilityCount,event:N,loadingStates:eY,renderConfirmNotVerifyEmailButtonCond:e4,isVerificationCodeSending:e3,onSubmit:tT,skipConfirmStep:tx,shouldRenderCaptcha:tb,watchedCfToken:eX,confirmButtonDisabled:Q,confirmStepClassNames:D?.confirmStep,hideAvailableTimesHeader:!0})]})}),(0,a.jsx)(ty.Toaster,{position:"bottom-right"})]})},rt=e=>(0,a.jsx)(tm.LazyMotion,{strict:!0,features:te,children:(0,a.jsx)(re,{...e})}),ra=e=>{let t=(0,ep.useRouter)(),d=(0,ep.usePathname)(),u=(0,ep.useSearchParams)(),c=(0,e0.useEvent)({disabled:!!e.eventData,fromRedirectOfNonOrgLink:e.entity.fromRedirectOfNonOrgLink}),m=e.eventData?{data:e.eventData,isSuccess:!0,isError:!1,isPending:!1}:c,f=(e=>{let[t,a]=(0,n.useBookerStoreContext)(e=>[e.layout,e.setLayout],l.shallow),r=(0,o.useIsEmbed)(),s=(0,Q.default)("(max-width: 768px)"),d=(0,Q.default)("(max-width: 1024px)"),u=(0,o.useEmbedUiConfig)(),c=r?s?"mobile":Z(u.layout)||t:t,m=d?H[c].tablet:H[c].desktop,f=(0,o.useEmbedType)(),g=r&&"inline"!==f,h=(0,i.useRef)(d?H[c].tablet:H[c].desktop),p=e||z.defaultBookerLayoutSettings,x=r&&Z(u.layout)||p.defaultLayout;(0,i.useEffect)(()=>{s&&"mobile"!==c?a("mobile"):s||"mobile"!==c||a(x)},[s,a,c,x]),(0,i.useEffect)(()=>{let e=(0,q.getQueryParam)("layout");if(!s&&!r&&Z(e)&&p?.enabledLayouts?.length&&e!==t){let t=p.enabledLayouts.find(t=>t===e);t&&a(t)}},[p,a,t,r,s]);let v={mobile:!r,month_view:!1,week_view:!0,column_view:!0}[c],y=(0,q.getQueryParam)("hideEventTypeDetails"),b=r?u.hideEventTypeDetails:"string"==typeof y&&"true"===y;return{shouldShowFormInDialog:v,hasDarkBackground:g,extraDays:m,columnViewExtraDays:h,isMobile:s,isEmbed:r,isTablet:d,layout:c,defaultLayout:x,hideEventTypeDetails:b,slotsViewOnSmallScreen:(0,o.useSlotsViewOnSmallScreen)(),bookerLayouts:p}})(m.data?.profile?.bookerLayouts),g=(0,n.useBookerStoreContext)(e=>e.selectedDate),h=u?.get("redirected")==="true",p=u?.get("username")||"",x=new URLSearchParams(window.location.search).get("rescheduleUid"),v=new URLSearchParams(window.location.search).get("rescheduledBy"),y=new URLSearchParams(window.location.search).get("bookingUid"),b=u?.get("cal.tz")||null;(0,i.useEffect)(()=>{r.sdkActionManager?.fire("navigatedToBooker",{})},[]),(0,X.useInitializeBookerStore)({...e,eventId:e.entity.eventTypeId??m?.data?.id,rescheduleUid:x,rescheduledBy:v,bookingUid:y,layout:f.isMobile?"mobile":f.defaultLayout,org:e.entity.orgSlug,timezone:b}),(0,n.useInitializeBookerStoreContext)({...e,eventId:e.entity.eventTypeId??m?.data?.id,rescheduleUid:x,rescheduledBy:v,bookingUid:y,layout:f.isMobile?"mobile":f.defaultLayout,org:e.entity.orgSlug,timezone:b});let[k]=(0,n.useBookerStoreContext)(e=>[e.dayCount,e.setDayCount],l.shallow),{data:S}=(0,eJ.useSession)(),w=(0,e3.useRouterQuery)(),C=!!S,T=u?.get("firstName"),E=u?.get("lastName"),j=Object.keys(w).filter(e=>e.startsWith("metadata")).reduce((e,t)=>({...e,[t.substring(9,t.length-1)]:u?.get(t)}),{}),N=(0,i.useMemo)(()=>({name:u?.get("name")||(T?`${T} ${E}`:null),guests:(u?.getAll("guests")||u?.getAll("guest"))??[]}),[u,T,E]),_=(({event:e,sessionEmail:t,sessionName:a,sessionUsername:r,hasSession:o,extraOptions:s,prefillFormParams:n,clientId:l})=>{let d=(0,X.useBookerStore)(e=>e.rescheduleUid),u=(0,X.useBookerStore)(e=>e.bookingData),{t:c}=(0,ef.useLocale)(),m=(0,i.useRef)(null),f=J.z.object({responses:e?function({bookingFields:e,view:t,translateFn:a}){return em({schema:z.bookingResponses.and(et.default.record(et.default.any())),bookingFields:e,isPartialSchema:!1,view:t,translateFn:a})}({bookingFields:e.bookingFields,view:d?"reschedule":"booking",translateFn:(e,t)=>c(e,t??{})}):J.z.object({})}).passthrough(),{values:g,key:h}=function({eventType:e,rescheduleUid:t,isRescheduling:a,email:r,name:o,username:s,hasSession:n,extraOptions:l,prefillFormParams:d,clientId:u}){let c=Object.entries(l).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>Array.isArray(t)?`${e}:${t.sort().join(",")}`:`${e}:${t}`).join("|"),[m,f]=(0,i.useState)({values:{},key:""}),g=(0,X.useBookerStore)(e=>e.bookingData),h=(0,X.useBookerStore)(e=>e.formValues),p=e?.team?.parent?.organizationSettings?.disableAutofillOnBookingPage??e?.owner?.profile?.organization?.organizationSettings?.disableAutofillOnBookingPage??!1;return(0,i.useEffect)(()=>{(async()=>{let i,m;if(Object.keys(h).length)return f({values:h,key:eg({values:h,hasSession:n,stableHashExtraOptions:c})});if(!e?.bookingFields)return;let x=(({bookingFields:e,view:t,translateFn:a})=>em({schema:z.bookingResponses.unwrap().partial().and(ed),bookingFields:e,isPartialSchema:!0,view:t,translateFn:a}))({bookingFields:e.bookingFields,view:t?"reschedule":"booking"}),v=p?{}:{...l,name:d.name,guests:d.guests},y=await x.parseAsync(v),b=(i=t&&g&&g.attendees.length>0?g.attendees[0].email??"":"",m=t&&g&&g.attendees.length>0?g.attendees[0].name??"":"",p?{email:i,name:m}:{email:i||(y.email?y.email:r??""),name:m||(y.name?y.name:o??s??"")});if(u&&(b.email=b.email.replace(`+${u}`,"")),!a){let t={responses:{}};t.responses={...e.bookingFields.reduce((e,t)=>({...e,[t.name]:y[t.name]||void 0}),{}),name:b.name,email:b.email??""},f({values:t,key:eg({values:t,hasSession:n,stableHashExtraOptions:c})})}if(!t&&!g)return;let k={responses:{},bookingId:g?.id};k.responses={...e.bookingFields.reduce((e,t)=>({...e,[t.name]:g?.responses[t.name]}),{}),name:b.name,email:b.email??""},f({values:k,key:eg({values:k,hasSession:n,stableHashExtraOptions:c})})})()},[e?.bookingFields,h,a,g,g?.id,t,r,o,s,d,c,p]),m}({eventType:e,rescheduleUid:d,isRescheduling:!!d&&!!u,email:t,name:a,username:r,hasSession:o,extraOptions:s,prefillFormParams:n,clientId:l}),p=(0,G.useForm)({defaultValues:g,resolver:(0,K.zodResolver)(f,{},{mode:"async"})});(0,i.useEffect)(()=>{p.reset(g)},[h]);let x=p.watch("responses.email"),v=p.watch("responses.name"),y={hasFormErrors:!!p.formState.errors.globalError,formErrors:p.formState.errors.globalError};return{bookingForm:p,bookerFormErrorRef:m,key:h,formEmail:x,formName:v,beforeVerifyEmail:()=>{if(p.clearErrors(),!e)return void p.setError("globalError",{message:c("error_booking_event")})},formErrors:y,errors:y}})({event:m.data,sessionEmail:S?.user.email,sessionUsername:S?.user.username,sessionName:S?.user.name,hasSession:C,extraOptions:w,prefillFormParams:N}),I=(({hasSession:e})=>{let t=(0,ep.useSearchParams)(),a=(0,X.useBookerStore)(e=>e.selectedDate),{timezone:r}=(0,eZ.useTimePreferences)(),o=t?.get("overlayCalendar")==="true"||eM.localStorage?.getItem("overlayCalendarSwitchDefault")==="true",[s,n]=(0,i.useState)(()=>{let e=eM.localStorage.getItem("toggledConnectedCalendars");return new Set(e?JSON.parse(e):[])}),[d]=(0,eH.useOverlayCalendarStore)(e=>[e.calendarSettingsOverlayModal,e.setCalendarSettingsOverlayModal],l.shallow),{data:u,isError:c}=eA.trpc.viewer.availability.calendarOverlay.useQuery({loggedInUsersTz:r||"Europe/London",dateFrom:a,dateTo:a,calendarsToLoad:Array.from(s).map(e=>({credentialId:e.credentialId,externalId:e.externalId}))},{enabled:e&&s.size>0&&o});(0,i.useEffect)(function(){c&&n(new Set([]))},[c]);let{data:m,isPending:f}=eA.trpc.viewer.calendars.connectedCalendars.useQuery({skipSync:!0},{enabled:!!d||!!t?.get("overlayCalendar")});return{overlayBusyDates:u,isOverlayCalendarEnabled:o,connectedCalendars:m?.connectedCalendars||[],loadingConnectedCalendar:f,onToggleCalendar:n}})({hasSession:C}),B=(({email:e,name:t,requiresBookerEmailVerification:a,onVerifyEmail:r})=>{let[o,s]=(0,i.useState)(!1),n=(0,X.useBookerStore)(e=>e.verifiedEmail),l=(0,X.useBookerStore)(e=>e.setVerifiedEmail),d=(0,X.useBookerStore)(e=>!!(e.rescheduleUid&&e.bookingData)),u=(0,eX.useDebounce)(e,600),{data:c}=(0,eJ.useSession)(),{t:m,i18n:f}=(0,ef.useLocale)(),g=eA.trpc.viewer.auth.sendVerifyEmailCode.useMutation({onSuccess:()=>{s(!0),(0,e_.showToast)(m("email_sent"),"success")},onError:()=>{(0,e_.showToast)(m("email_not_sent"),"error")}}),{data:h}=eA.trpc.viewer.public.checkIfUserEmailVerificationRequired.useQuery({userSessionEmail:c?.user.email||"",email:u},{enabled:!!u&&!d});return{handleVerifyEmail:()=>{r?.(),g.mutate({email:e,username:"string"==typeof t?t:t?.firstName,language:f.language||"en"})},isEmailVerificationModalVisible:o,setEmailVerificationModalVisible:s,setVerifiedEmail:l,renderConfirmNotVerifyEmailButtonCond:!!(d||!a&&!h||e&&n&&n===e),isVerificationCodeSending:g.isPending}})({email:_.formEmail,name:_.formName,requiresBookerEmailVerification:m?.data?.requiresBookerEmailVerification,onVerifyEmail:_.beforeVerifyEmail}),O=(e=>{let t=(0,n.useBookerStoreContext)(e=>e.selectedDuration),a=(0,eK.useCompatSearchParams)(),[r,o,s,d]=(0,n.useBookerStoreContext)(e=>[e.selectedTimeslot,e.setSelectedTimeslot,e.tentativeSelectedTimeslots,e.setTentativeSelectedTimeslots],l.shallow),[u,c]=[eq,function(e){eq=e}],m=eA.trpc.viewer.slots.reserveSlot.useMutation({trpc:{context:{skipBatch:!0}},onSuccess:e=>{c(e.uid)}}),f=eA.trpc.viewer.slots.removeSelectedSlotMark.useMutation({trpc:{context:{skipBatch:!0}}}),g=e?.id,h=t||e?.length||0,p=[...s,r].filter(e=>null!==e),x=(({eventTypeId:e,eventDuration:t,timeslotsAsISOString:a,slotReservationId:r})=>{let o=(0,i.useRef)([]);if(!eG())return o.current;let s=a.map(e=>{let a=(0,ek.default)(e);return{utcStartIso:a.utc().toISOString(),utcEndIso:a.add(t,"minutes").utc().toISOString()}}),n=eA.trpc.viewer.slots.isAvailable.useQuery({slots:s,eventTypeId:e},{refetchInterval:1e3*eQ.PUBLIC_QUERY_RESERVATION_INTERVAL_SECONDS,refetchOnWindowFocus:!0,enabled:!!(e&&a.length>0&&r),staleTime:1e3*eQ.PUBLIC_QUERY_RESERVATION_STALE_TIME_SECONDS}),l=n.data?.slots;return l&&l.length>0&&(o.current=l),l||o.current})({eventTypeId:g,eventDuration:h,timeslotsAsISOString:Array.from(new Set(p)),slotReservationId:u}),v=r??p.at(-1),y=()=>{g&&v&&h&&m.mutate({slotUtcStartDate:(0,ek.default)(v).utc().toISOString(),eventTypeId:g,slotUtcEndDate:(0,ek.default)(v).utc().add(h,"minutes").toISOString(),_isDryRun:(0,eS.isBookingDryRun)(a)})};return(0,i.useEffect)(()=>{y();let t=setInterval(()=>{y()},60*parseInt(eQ.MINUTES_TO_BOOK)*1e3-2e3);return()=>{e?.id&&u&&f.mutate({uid:u}),clearInterval(t)}},[e?.id,v]),{setSelectedTimeslot:o,setTentativeSelectedTimeslots:d,selectedTimeslot:r,tentativeSelectedTimeslots:s,slotReservationId:u,allSelectedTimeslots:p,quickAvailabilityChecks:x}})(m?.data?{id:m.data.id,length:m.data.length}:null),L=(0,o.useIsEmbed)(),D=(0,e0.useScheduleForEvent)({eventId:e.entity.eventTypeId??m.data?.id,username:e.username,dayCount:k,eventSlug:e.eventSlug,month:e.month,duration:e.duration,selectedDate:g,teamMemberEmail:e.teamMemberEmail,fromRedirectOfNonOrgLink:e.entity.fromRedirectOfNonOrgLink,isTeamEvent:e.isTeamEvent??!!m.data?.team,useApiV2:e.useApiV2,bookerLayout:f,...e.entity.orgSlug?{orgSlug:e.entity.orgSlug}:{},restrictionSchedule:m.data?.restrictionScheduleId?{id:m.data.restrictionScheduleId,useBookerTimezone:m.data.useBookerTimezone}:void 0}),R=(({event:e,hashedLink:t,bookingForm:a,metadata:o,isBookingDryRun:s})=>{let d=(0,ep.useRouter)(),u=(0,n.useBookerStoreContext)(e=>e.eventSlug),c=(0,n.useBookerStoreContext)(e=>e.eventId),m=(0,n.useBookerStoreContext)(e=>e.isInstantMeeting),[f,g]=(0,n.useBookerStoreContext)(e=>[e.rescheduleUid,e.setRescheduleUid],l.shallow),h=(0,n.useBookerStoreContext)(e=>e.rescheduledBy),[p,x]=(0,n.useBookerStoreContext)(e=>[e.bookingData,e.setBookingData],l.shallow),v=(0,n.useBookerStoreContext)(e=>e.selectedTimeslot),{t:y}=(0,ef.useLocale)(),b=(0,eU.useBookingSuccessRedirect)(),k=(0,i.useRef)(null),[S,w]=(0,i.useState)(),[C,T]=(0,i.useState)(),E=(0,n.useBookerStoreContext)(e=>e.selectedDuration),j=!!f&&!!p,N=(0,q.getQueryParam)("bookingUid")??"";(0,i.useEffect)(()=>{if(!m)return;let e=eM.localStorage.getItem(ez);if(e){let t=JSON.parse(e),a=t.eventTypeId===c&&m&&new Date(t.expiryTime)>new Date?t:null;a&&(w(a.expiryTime),(0,q.updateQueryParam)("bookingUid",a.bookingUid))}},[c,m]);let _=eY(c),I=eA.trpc.viewer.bookings.getInstantBookingLocation.useQuery({bookingUid:N},{enabled:!!N&&m,refetchInterval:2e3,refetchIntervalInBackground:!0});(0,i.useEffect)(function(){let e=I.data;if(e&&e.booking&&m)try{let t=z.bookingMetadataSchema.parse(e.booking?.metadata||{})?.videoCallUrl;t?T(t):(0,e_.showToast)(y("something_went_wrong_on_our_end"),"error")}catch{(0,e_.showToast)(y("something_went_wrong_on_our_end"),"error")}},[I.data,m]);let B=(0,eh.useMutation)({mutationFn:eB.createBooking,onSuccess:t=>{if(t.isDryRun){j?r.sdkActionManager?.fire("dryRunRescheduleBookingSuccessfulV2",eV({...t,isRecurring:!1})):r.sdkActionManager?.fire("dryRunBookingSuccessfulV2",eV({...t,isRecurring:!1})),d.push("/booking/dry-run-successful");return}if("isShortCircuitedBooking"in t&&t.isShortCircuitedBooking){if(!t.uid)return void console.error("Decoy booking missing uid");let e={uid:t.uid,title:t.title??null,startTime:t.startTime,endTime:t.endTime,booker:t.attendees?.[0]??null,host:t.user??null,location:t.location??null};return(0,eI.storeDecoyBooking)(e),void d.push(`/booking-successful/${t.uid}`)}let{uid:o,paymentUid:s}=t,n=(0,er.getFullName)(a.getValues("responses.name")),i=e.data?.subsetOfHosts?.length?e.data?.subsetOfHosts.map(e=>e.user):e.data?.subsetOfUsers,l=e.data?.isDynamic?E||e.data?.length:E&&e.data?.metadata?.multipleDuration?.includes(E)?E:e.data?.length;if(j?(r.sdkActionManager?.fire("rescheduleBookingSuccessful",{booking:t,eventType:e.data,date:t?.startTime?.toString()||"",duration:l,organizer:{name:i?.[0]?.name||"Nameless",email:t?.userPrimaryEmail||t.user?.email||"Email-less",timeZone:t.user?.timeZone||"Europe/London"},confirmed:!(t.status===eP.BookingStatus.PENDING&&e.data?.requiresConfirmation)}),r.sdkActionManager?.fire("rescheduleBookingSuccessfulV2",eF({...t,isRecurring:!1}))):(r.sdkActionManager?.fire("bookingSuccessful",{booking:t,eventType:e.data,date:t?.startTime?.toString()||"",duration:l,organizer:{name:i?.[0]?.name||"Nameless",email:t?.userPrimaryEmail||t.user?.email||"Email-less",timeZone:t.user?.timeZone||"Europe/London"},confirmed:!(t.status===eP.BookingStatus.PENDING&&e.data?.requiresConfirmation)}),r.sdkActionManager?.fire("bookingSuccessfulV2",eF({...t,isRecurring:!1}))),s)return void d.push((0,ex.createPaymentLink)({paymentUid:s,date:v,name:n,email:a.getValues("responses.email"),absolute:!1}));if(!o)return void console.error("No uid returned from createBookingMutation");let c={isSuccessBookingPage:!0,email:a.getValues("responses.email"),eventTypeSlug:u,seatReferenceUid:"seatReferenceUid"in t?t.seatReferenceUid:null,formerTime:j&&p?.startTime?(0,ek.default)(p.startTime).toString():void 0,rescheduledBy:h};b({successRedirectUrl:e?.data?.successRedirectUrl||"",query:c,booking:t,forwardParamsSuccessRedirect:e?.data?.forwardParamsSuccessRedirect===void 0||e?.data?.forwardParamsSuccessRedirect})},onError:e=>{k?.current&&k.current.scrollIntoView({behavior:"smooth"}),e.message===eR.ErrorCode.BookerLimitExceededReschedule&&e.data?.rescheduleUid&&(g(e.data?.seatUid??e.data?.rescheduleUid),x({uid:e.data?.rescheduleUid,startTime:e.data?.startTime,attendees:e.data?.attendees}))}}),O=(0,eh.useMutation)({mutationFn:eL,onSuccess:e=>{c&&((({eventTypeId:e,expiryTime:t,bookingUid:a})=>{let r=JSON.stringify({eventTypeId:e,expiryTime:t,bookingUid:a});eM.localStorage.setItem(ez,r)})({eventTypeId:c,expiryTime:e.expires,bookingUid:e.bookingUid}),(e=>{if(!e)return;let t=e$();t[String(e)]=Date.now();try{eM.localStorage.setItem(eW,JSON.stringify(t))}catch{}})(c)),(0,q.updateQueryParam)("bookingUid",e.bookingUid),w(e.expires)},onError:e=>{console.error("Error creating instant booking",e),k?.current&&k.current.scrollIntoView({behavior:"smooth"})}}),L=(0,eh.useMutation)({mutationFn:eD,onSuccess:async t=>{let o=t[0]||{};if(o.isDryRun){j?r.sdkActionManager?.fire("dryRunRescheduleBookingSuccessfulV2",{...eV({...o,isRecurring:!0}),allBookings:t.map(e=>({startTime:e.startTime,endTime:e.endTime}))}):r.sdkActionManager?.fire("dryRunBookingSuccessfulV2",{...eV({...o,isRecurring:!0}),allBookings:t.map(e=>({startTime:e.startTime,endTime:e.endTime}))}),d.push("/booking/dry-run-successful");return}let{uid:s}=o;if(!s)return void console.error("No uid returned from createRecurringBookingMutation");let n={isSuccessBookingPage:!0,allRemainingBookings:!0,email:a.getValues("responses.email"),eventTypeSlug:u,formerTime:j&&p?.startTime?(0,ek.default)(p.startTime).toString():void 0};j?r.sdkActionManager?.fire("rescheduleBookingSuccessfulV2",{...eF({...o,isRecurring:!0}),allBookings:t.map(e=>({startTime:e.startTime,endTime:e.endTime}))}):r.sdkActionManager?.fire("bookingSuccessfulV2",{...eF({...o,isRecurring:!0}),allBookings:t.map(e=>({startTime:e.startTime,endTime:e.endTime}))}),b({successRedirectUrl:e?.data?.successRedirectUrl||"",query:n,booking:o,forwardParamsSuccessRedirect:e?.data?.forwardParamsSuccessRedirect===void 0||e?.data?.forwardParamsSuccessRedirect})},onError:(e,t,a)=>{console.error("Error creating recurring booking",e),k&&k.current?.scrollIntoView({behavior:"smooth"})}}),D=(({bookingForm:e,event:t,metadata:a,hashedLink:r,handleBooking:o,handleInstantBooking:s,handleRecBooking:i,locationUrl:l,routingFormSearchParams:d,isBookingDryRun:u,rrHostSubsetIds:c})=>{let m=(0,ev.useIsPlatform)(),f=(0,n.useBookerStoreContext)(e=>e.setFormValues),g=(0,n.useBookerStoreContext)(e=>e.selectedTimeslot),h=(0,n.useBookerStoreContext)(e=>e.selectedDuration),{timezone:p}=(0,ey.useBookerTime)(),x=(0,n.useBookerStoreContext)(e=>e.rescheduleUid),v=(0,n.useBookerStoreContext)(e=>e.rescheduledBy),{t:y,i18n:b}=(0,ef.useLocale)(),k=(0,n.useBookerStoreContext)(e=>e.username),S=(0,n.useBookerStoreContext)(e=>e.recurringEventCount),w=(0,n.useBookerStoreContext)(e=>e.bookingData),C=(0,n.useBookerStoreContext)(e=>e.seatedEventData),T=(0,n.useBookerStoreContext)(e=>e.isInstantMeeting),E=(0,n.useBookerStoreContext)(e=>e.org),j=(0,n.useBookerStoreContext)(e=>e.teamMemberEmail),N=(0,n.useBookerStoreContext)(e=>e.crmOwnerRecordType),_=(0,n.useBookerStoreContext)(e=>e.crmAppSlug),I=(0,n.useBookerStoreContext)(e=>e.crmRecordId),B=(0,n.useBookerStoreContext)(e=>e.verificationCode),O=e=>{let t=e instanceof Error?y(e.message):y("can_you_try_again");(0,e_.showToast)(t,"error")},L=(0,ep.useSearchParams)();return n=>{let D=e.getValues(),R=n??g,M=n&&!m?{onError:O}:void 0;if(R){if(f({}),e.clearErrors(),!t?.data)return void e.setError("globalError",{message:y("error_booking_event")});let n={values:D,duration:t.data.isDynamic?h||t.data.length:h&&t.data.metadata?.multipleDuration?.includes(h)?h:t.data.length,event:t.data,date:R,timeZone:p,language:b.language,rescheduleUid:x||void 0,rescheduledBy:v||void 0,bookingUid:w&&w.uid||C?.bookingUid||void 0,username:k||"",metadata:a,hashedLink:r,teamMemberEmail:j,crmOwnerRecordType:N,crmAppSlug:_,crmRecordId:I,orgSlug:E||void 0,routingFormSearchParams:d,isDryRunProp:u,verificationCode:B||void 0,rrHostSubsetIds:c},m=function(e){if(!e)return;let t=Object.fromEntries(["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].map(t=>[t,e.get(t)??void 0]));return Object.values(t).every(e=>void 0===e)?void 0:t}(L);T?s(eN(n),M):t.data?.recurringEvent?.freq!=null&&S&&!x?i(((e,t,a)=>{let r=(0,eb.v4)(),[,o]=ej({startDate:e.date,timeZone:e.timeZone,recurringEvent:e.event.recurringEvent,recurringCount:t,withDefaultTimeFormat:!0},e.language),s=eN({...e,bookingUid:void 0});return o.map(t=>({...s,start:(0,ek.default)(t).format(),end:(0,ek.default)(t).add(e.duration||e.event.length,"minute").format(),recurringEventId:r,schedulingType:e.event.schedulingType||void 0,recurringCount:o.length,tracking:a}))})(n,S,m),M):o({...eN(n),locationUrl:l,tracking:m},M),f({}),e.clearErrors()}}})({event:e,bookingForm:a,hashedLink:t,metadata:o,handleInstantBooking:e=>{let t=eY(c);t>0?(0,e_.showToast)(y("please_try_again_later_or_book_another_slot",{remaining:Math.ceil(t/6e4)}),"error"):O.mutate(e)},handleRecBooking:L.mutate,handleBooking:B.mutate,isBookingDryRun:s});return{handleBookEvent:D,expiryTime:S,bookingForm:a,bookerFormErrorRef:k,errors:{hasDataErrors:!!(B.isError||L.isError||O.isError),dataErrors:B.error||L.error||O.error},loadingStates:{creatingBooking:B.isPending||B.isSuccess,creatingRecurringBooking:L.isPending||L.isSuccess,creatingInstantBooking:O.isPending},instantVideoMeetingUrl:C,instantConnectCooldownMs:_,bookingUid:N}})({event:m,hashedLink:e.hashedLink,bookingForm:_.bookingForm,metadata:j??{},teamMemberEmail:e.teamMemberEmail});(0,s.useBookerEmbedEvents)({eventId:m.data?.id,eventSlug:m.data?.slug,schedule:D});let M=(({onSuccess:e})=>{let{t}=(0,ef.useLocale)(),[a,r]=(0,i.useState)(!1),[o,s]=(0,i.useState)(""),[n,l]=(0,i.useState)(""),[d,u]=(0,i.useState)(!1),c=eA.trpc.viewer.organizations.verifyCode.useMutation({onSuccess:t=>{r(!1),e(t)},onError:e=>{r(!1),u(!1),"invalid_code"===e.message&&s(t("code_provided_invalid"))}}),m=eA.trpc.viewer.auth.verifyCodeUnAuthenticated.useMutation({onSuccess:t=>{r(!1),e(t)},onError:e=>{r(!1),u(!1),"invalid_code"===e.message&&s(t("code_provided_invalid"))}});return{verifyCodeWithSessionRequired:(e,t)=>{c.mutate({code:e,email:t})},verifyCodeWithSessionNotRequired:(e,t)=>{m.mutate({code:e,email:t})},isPending:a,setIsPending:r,error:o,value:n,hasVerified:d,setValue:l,setHasVerified:u,resetErrors:()=>s("")}})({onSuccess:()=>{_.formEmail&&(B.setVerifiedEmail(_.formEmail),B.setEmailVerificationModalVisible(!1),R.handleBookEvent())}}),P=(0,i.useCallback)(e=>{let a=new URL(window.location.href);e?(a.searchParams.set("overlayCalendar","true"),eM.localStorage.setItem("overlayCalendarSwitchDefault","true")):(a.searchParams.delete("overlayCalendar"),eM.localStorage.removeItem("overlayCalendarSwitchDefault")),t.push(`${a.pathname}${a.search}`)},[t]);(({brandColor:e,darkBrandColor:t,theme:a})=>{let r=(0,e1.default)({lightVal:e,darkVal:t});(0,e4.useCalcomTheme)(r),(0,e2.default)(a)})({brandColor:m.data?.profile.brandColor??eQ.DEFAULT_LIGHT_BRAND_COLOR,darkBrandColor:m.data?.profile.darkBrandColor??eQ.DEFAULT_DARK_BRAND_COLOR,theme:m.data?.profile.theme});let A=!!(m.data?.instantMeetingParameters&&u&&m.data.instantMeetingParameters?.every?.(e=>Array.from(u.values()).includes(e)));return(0,i.useEffect)(()=>{C&&P(!0)},[C]),(0,a.jsx)(rt,{...e,onGoBackInstantMeeting:()=>{d&&(window.location.href=d)},onConnectNowInstantMeeting:()=>{let e=`${d}?isInstantMeeting=true`;if(L){let t=`${new URL(document.URL).origin}/${e}`;window.open(t,"_blank","noopener,noreferrer")}else t.push(e)},onOverlayClickNoCalendar:()=>{t.push("/apps/categories/calendar")},onClickOverlayContinue:()=>{let e=new URL(`${eQ.WEBAPP_URL}/login`);e.searchParams.set("callbackUrl",window.location.pathname),e.searchParams.set("overlayCalendar","true"),t.push(e.toString())},onOverlaySwitchStateChange:P,sessionUsername:S?.user.username,isRedirect:h,fromUserNameRedirected:p,rescheduleUid:x,rescheduledBy:v,bookingUid:y,hasSession:C,hasValidLicense:S?.hasValidLicense??!1,extraOptions:w,bookings:R,calendars:I,slots:O,verifyEmail:B,bookerForm:_,event:m,bookerLayout:f,schedule:D,verifyCode:M,isPlatform:!1,areInstantMeetingParametersSet:A,userLocale:S?.user.locale,renderCaptcha:!0})};function rr({isEmbed:e}){return(0,tn.default)("flex h-full items-center justify-center",!e&&"min-h-[calc(100dvh)]")}e.s(["BookerWebWrapper",0,e=>(0,a.jsx)(n.BookerStoreProvider,{children:(0,a.jsx)(ra,{...e})})],692969),e.s(["getBookerWrapperClasses",()=>rr],658856);var ro=e.i(250804),rs=e.i(662537),rn=e.i(453288),ri=e.i(248097),rl=e.i(323758);function rd({children:e}){return(0,a.jsx)(ri.ErrorBoundary,{fallbackRender:({error:e,resetErrorBoundary:t})=>(0,a.jsx)(rl.ErrorPage,{reset:t,error:e,message:`${e}`,displayDebug:!0}),onError:(e,t)=>{console.error(e),function(e,{componentStack:t},a){let r;if(null!==(r=i.version.match(/^([^.]+)/))&&parseInt(r[0])>=17&&(0,rn.isError)(e)&&t){let a,r=Error(e.message);r.name=`React ErrorBoundary ${e.name}`,r.stack=t,a=new WeakSet,function e(t,r){if(!a.has(t)){if(t.cause)return a.add(t),e(t.cause,r);t.cause=r}}(e,r)}(0,ro.withScope)(a=>(a.setContext("react",{componentStack:t}),(0,rs.captureException)(e,void 0)))}(e,t)},children:e})}e.s(["default",()=>rd],255783)}]);

//# sourceMappingURL=3e77842e77495569.js.map